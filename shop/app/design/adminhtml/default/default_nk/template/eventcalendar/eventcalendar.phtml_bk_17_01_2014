<link rel="stylesheet" type="text/css" href="<?php echo $this->getSkinUrl().'calendar.css'?>"  />
<?php

    /*.......................Start Zend Services....................*/
    
    //$gcal = Zend_Gdata_Calendar::AUTH_SERVICE_NAME;
    $user = "artis.test70@gmail.com";
    $pass = "test@artis#200970";
    //$client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $gcal);
    //$gcal = new Zend_Gdata_Calendar($client);
    
    
    /****************************** Get permission in array ****************************************/
    
        $user = Mage::getSingleton('admin/session');
        $userId = $user->getUser()->getUserId();
        
        $connectionRead = Mage::getSingleton('core/resource')->getConnection('core_read');
        $connectionWrite = Mage::getSingleton('core/resource')->getConnection('core_write');
        
        $temptableUserTask=Mage::getSingleton('core/resource')->getTableName('user_task_relation');
        //$sqlUserTask="SELECT * FROM ".$temptableUserTask." WHERE user_id = '".$userId."'";
        $sqlUserTask = $connectionRead->select()
                        ->from($temptableUserTask, array('*'))
                        ->where('user_id=?',$userId);
        $chkUserTask = $connectionRead->fetchAll($sqlUserTask);
        
        
        foreach($chkUserTask as $usertask)
        {
                $all_permission[$usertask['task_id']] = $usertask['task_id'];	
        }
        
         Mage::getSingleton('core/session')->setAllpermission($all_permission);
         
         
         if(Mage::getSingleton('core/session')->getFormattype() == '')
         {
            $temptableUserTask=Mage::getSingleton('core/resource')->getTableName('user_task_relation');
            //$sqlUserTask="SELECT * FROM ".$temptableUserTask." WHERE user_id = '".$userId."' AND task_id IN(22,23,24,25,26) LIMIT 1";
            $sqlUserTask = $connectionRead->select()
                        ->from($temptableUserTask, array('*'))
                        ->where("user_id = '".$userId."' AND task_id IN(22,23,24,25,26)");
            $chkUserTask = $connectionRead->fetchAll($sqlUserTask);
            
            if($chkUserTask[0]['task_id'] == 22)
            Mage::getSingleton('core/session')->setFormattype('day');
            else if($chkUserTask[0]['task_id'] == 23)
            Mage::getSingleton('core/session')->setFormattype('week');
            else if($chkUserTask[0]['task_id'] == 24)
            Mage::getSingleton('core/session')->setFormattype('4day');
            else if($chkUserTask[0]['task_id'] == 25)
            Mage::getSingleton('core/session')->setFormattype('month');
            else if($chkUserTask[0]['task_id'] == 26)
            Mage::getSingleton('core/session')->setFormattype('year');
            
         }

    
    /****************************** Get permission in array ****************************************/
    
    function GreenYellowRed($number) {
                $number--; // working with 0-99 will be easier
              
                if ($number < 50) {
                  // green to yellow
                  $r = floor(255 * ($number / 50));
                  $g = 255;
              
                } else {
                  // yellow to red
                  $r = 255;
                  $g = floor(255 * ((50-$number%50) / 50));
                }
                $b = 0;
              
                return "$r,$g,$b";
              }
    
    /*.........................End...............................*/

    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
    //$sqlSaleOrder="SELECT entity_id,created_at FROM ".$temptableSaleOrder;//." WHERE is_event_set_to_google_calendar='0'";
    $sqlSaleOrder = $connectionRead->select()
                    ->from($temptableSaleOrder, array('entity_id,created_at'));
    try {
        $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
        
    
    
    
    } catch (Exception $e){
    //echo $e>getMessage();
    }
    
    
    
    
    foreach($chkSaleOrder as $res_chkSaleOrder) 
    {
        
        $title = "Order Id : ".$res_chkSaleOrder['entity_id']; //Event name or Product name
        $created_dt=$res_chkSaleOrder['created_at'];
        
        $arr=array();
        
        
        $arr=explode(" ",$created_dt);
        
        $dt=$arr[0];
        $tm=$arr[1];
        
        
        $arr_dt=array();
        $arr_dt=explode("-",$dt);
        
        $arr_tm=array();
        $arr_dm=explode(":",$tm);
        
        $time_val=mktime($arr_tm[0],$arr_tm[1],$arr_tm[2],$arr_dt[1],$arr_dt[2],$arr_dt[0]);
        
       
        
        $date_mm = date("m",$time_val);      //Start date (only month)
        $date_dd = date("d",$time_val);      //Start date (only date)
        $date_yy = date("Y",$time_val);      //Start date (only Year)
        
        $edate_mm = date("m",$time_val);     //End date (only month)
        $edate_dd = date("d",$time_val);     //End date (only date)
        $edate_yy = date("Y",$time_val);     //End date (only year)
        
        $start_hh = date("H",$time_val);     //Start time (hh)
        $start_ii = date("i",$time_val);     //Start time (ii)
        
        $end_hh = date("H",$time_val+5);     //End time (hh)
        $end_ii = date("i",$time_val+5);     //End time (ii)
        
        
        if (empty($title)) {
          //die('ERROR: Missing title');
        } 
        
        if (!checkdate($date_mm, $date_dd, $date_yy)) {
          //die('ERROR: Invalid start date/time');        
        }
        
        if (!checkdate($edate_mm, $edate_dd, $edate_yy)) {
          //die('ERROR: Invalid end date/time');        
        }
        
        $title = htmlentities($title);
        $start = date(DATE_ATOM, mktime($start_hh, $start_ii, 
         0, $date_mm, $date_dd, $date_yy));
        $end = date(DATE_ATOM, mktime($end_hh, $end_ii, 
         0, $edate_mm, $edate_dd, $edate_yy));
  
        // construct event object
        // save to server      
        try {
         // $event = $gcal->newEventEntry();        
         // $event->title = $gcal->newTitle($title);        
         // $when = $gcal->newWhen();
         // $when->startTime = $start;
         // $when->endTime = $end;
        //  $event->when = array($when);        
         // $gcal->insertEvent($event);
          
        } catch (Zend_Gdata_App_Exception $e) {
          //echo "Error: " . $e->getResponse();
        }
       
        
        //$sqlOrder="UPDATE ".$temptableSaleOrder." SET is_event_set_to_google_calendar='1' WHERE entity_id='".$res_chkSaleOrder['entity_id']."'";
        $connectionWrite->beginTransaction();
        $data = array();
        $data['is_event_set_to_google_calendar'] = 1;
        $where = $connectionWrite->quoteInto('entity_id =?', $res_chkSaleOrder['entity_id']);
        $connectionWrite->update($temptableSaleOrder, $data, $where);
        $connectionWrite->commit();
        try {
            //$chkOrder = Mage::getSingleton('core/resource')->getConnection('core_write')->query($sqlOrder);
            
            
        
        
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
    }


?>

<!--<iframe src="https://www.google.com/calendar/embed?height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=artis.test70%40gmail.com&amp;color=%232952A3&amp;src=en.indian%23holiday%40group.v.calendar.google.com&amp;color=%232F6309&amp;src=en_gb.usa%23holiday%40group.v.calendar.google.com&amp;color=%23B1440E&amp;ctz=Asia%2FCalcutta" style=" border-width:0 " width="100%" height="600" frameborder="0" scrolling="no"></iframe>-->

<?php
    
function scheduler_calendar($month,$year,$dateArray) {

     // Create array containing abbreviations of days of week.
     $daysOfWeek = array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sat');
     $daysOfWeek1 = array('Sun','Mon','Tue','Wed','Thu','Fri','Sat');

     // What is the first day of the month in question?
     $firstDayOfMonth = mktime(0,0,0,$month,1,$year);

     // How many days does this month contain?
     $numberDays = date('t',$firstDayOfMonth);

     // Retrieve some information about the first day of the
     // month in question.
     $dateComponents = getdate($firstDayOfMonth);

     // What is the name of the month in question?
     $monthName = $dateComponents['month'];

     // What is the index value (0-6) of the first day of the
     // month in question.
     $dayOfWeek = $dateComponents['wday'];

     // Create the table tag opener and day headers
   
     
    $todays_date=date("d",time());
    $current_month=date("m",time());
    
    $next_month=$month;
    $next_year=$year;
    
    $prev_month=$month;
    $prev_year=$year;
    
    
    $next_month++;
    if($next_month>12)
    {
       $next_month=1;
       $next_year++;
    }
    
    $prev_month--;
    if($prev_month<1)
    {
       $prev_month=12;
       $prev_year--;
    }
    
    $country = Mage::getSingleton('admin/session')->getCountryholiday();
    
    if($country == '')
    $country = 0;
    
    /******************* Start Holiday parse ***********************/
    $short = rtrim(Mage::getSingleton('core/session')->getRemoveholi(),',');
    $connectionRead = Mage::getSingleton('core/resource')->getConnection('core_read');
    $connectionWrite = Mage::getSingleton('core/resource')->getConnection('core_write');
      
      if($short != '')
      $sql = " country_name NOT IN(".$short.")";
      
     $temptableHoliday=Mage::getSingleton('core/resource')->getTableName('holiday');
    //$sqlHoliday="SELECT * FROM ".$temptableHoliday.$sql;
    //$chkHoliday = Mage::getSingleton('core/resource')->getConnection('core_read')->fetchall($sqlHoliday);
    
    if($short != ''){
        $sqlHoliday = $connectionRead->select()
                  ->from($temptableHoliday, array('*'))
                  ->where($sql);
        }else{
        $sqlHoliday = $connectionRead->select()
                  ->from($temptableHoliday, array('*'));
        }
    
    foreach($chkHoliday as $holidays)
      {
          $dateHoli = getdate(strtotime($holidays['h_date']));
         
         $day = $daysOfWeek1[$dateHoli['wday']];
         $monthHoli = $dateHoli['month'];
         $dateHoli = $dateHoli['mday'];
         
           if($holyday[$holidays['h_date']] != '')
        $holyday[$holidays['h_date']] .= '<div style="background-color: '.$holidays['color'].';cursor:pointer;" class="holilink" onclick="holipop(\''.$holidays['h_date'].'\')"> '.$holidays['event'].'</div><div style="display:none;" id="details_'.$holidays['h_date'].'" class="holipop"><div  style="cursor:pointer" class="holiclose" onclick="holiclose()">X</div><div style="color:'.$holidays['color'].';font-weight:bold;">'.$holidays['event'].'</div><div>'.$day.', '.$monthHoli.' '.$dateHoli.'</div><div><strong>Calenar</strong> '.$holidays['country_name'].' Holiday</div></div>';
        else
        $holyday[$holidays['h_date']] = '<div style="background-color: '.$holidays['color'].';cursor:pointer;" class="holilink" onclick="holipop(\''.$holidays['h_date'].'\')"> '.$holidays['event'].'</div><div style="display:none;" id="details_'.$holidays['h_date'].'" class="holipop"><div style="cursor:pointer" class="holiclose" onclick="holiclose()">X</div><div style="color:'.$holidays['color'].';font-weight:bold;">'.$holidays['event'].'</div><div>'.$day.', '.$monthHoli.' '.$dateHoli.'</div><div><strong>Calenar</strong> '.$holidays['country_name'].' Holiday</div></div>';
      }
    /******************* End Holiday parse ***********************/
    

    $path = $country;
     $calendar = "<table width='100%' style='margin-top: -232px;' border='0' cellspacing='0' cellpadding='0' class='sc_calendar'>";
     $calendar .= "<caption>$monthName $year</caption><div class='prev-next'><div style='float:left;' class='prevdiv' onclick='sc_prev_month($prev_month,$prev_year,\"".$path."\");'>        
                                   <a href='javascript:void(0);' class='arr_l' onclick='sc_prev_month($prev_month,$prev_year,\"".$path."\");'><< Previous Month</a>
                               </div>
                               <div style='float:right;' class='nextdiv' onclick='sc_next_month($next_month,$next_year,\"".$path."\");'>        
                                   <a href='javascript:void(0);' class='arr_r' onclick='sc_next_month($next_month,$next_year,\"".$path."\");'>Next Month >></a>  
                               </div></div>  ";
     $calendar .= " <div class='calfomat'><div  class='fday' onclick='sc_loadXMLDoc($month,$year,\"".$path."\",".date('d').",\"day\");'>        
                                   <a href='javascript:void(0);' class='arr_r' onclick='sc_loadXMLDoc($month,$year,\"".$path."\",".date('d').",\"day\");'>Day</a>  
                               </div>
                                 
                           ";
    $calendar .= "
                           <div  class='fmonth' onclick='sc_loadXMLDoc($month,$year,\"".$path."\");'>        
                                   <a href='javascript:void(0);' class='arr_r' onclick='sc_loadXMLDoc($month,$year,\"".$path."\");'>Month</a>  
                               </div></div>
                                 
                           ";
     $calendar .= "<tr>";

     // Create the calendar headers

     foreach($daysOfWeek1 as $day) {
          $calendar .= "<th class='sc_header'>$day</th>";
     } 

     // Create the rest of the calendar

     // Initiate the day counter, starting with the 1st.

     $currentDay = 1;

     $calendar .= "</tr><tr>";

     // The variable $dayOfWeek is used to
     // ensure that the calendar
     // display consists of exactly 7 columns.

     if ($dayOfWeek > 0) { 
          //$calendar .= "<td colspan='$dayOfWeek'>&nbsp;</td>";
          
            $format = 'Y-m-j'; 
            $firstdate = date ( $format, strtotime ( '-'.$dayOfWeek.' day' . $year.'-'.$month.'-01' ) );
            $numberDaysoflast = date('t',strtotime ( '-'.$dayOfWeek.' day' . $year.'-'.$month.'-01' ));
            $currentday2 = explode('-',$firstdate);
            
          $predate = 0;
                    for($predate = 0;$predate < $dayOfWeek;$predate++)
          {
           $currentday3 = $currentday2[2]+$predate;
            $start_time=date("Y-m-d H:i:s",mktime(0,0,0,$prev_month,$currentday3,$prev_year));
        $end_time=date("Y-m-d H:i:s",mktime(23,59,59,$prev_month,$currentday3,$prev_year));
        
        $dateComponents1 = getdate(mktime(0,0,0,$prev_month,$currentday3,$prev_year));
            $monthName1 = $dateComponents1['month'];
            $dayOfWeek1 = $dateComponents1['wday'];
        
        
        //All query Start
    
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
        //$sqlSaleOrder="SELECT count(entity_id) as ctct FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
			->from($temptableSaleOrder, array('count(entity_id) as ctct'))
			->where("created_at between '".$start_time."' AND '".$end_time."'");
        try {
            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
            
        
        
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $tot_order_placed=0;
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $tot_order_placed= $res_chkSaleOrder["ctct"];
           
           
        }
        
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
        //$sqlSaleOrder="SELECT entity_id FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
			->from($temptableSaleOrder, array('entity_id'))
			->where("created_at between '".$start_time."' AND '".$end_time."'");
        try {
            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
            
        
        
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $ord_id=array();
        $show_id=array();
        
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $ord_id[]=$res_chkSaleOrder["entity_id"];
           $show_id[]=str_pad($res_chkSaleOrder["entity_id"],9,"100000000",STR_PAD_LEFT);
           
           
        }
        
        if(count($ord_id)>0)
        {
            $clclcl="active_view";
        }
        else
        {
            $clclcl="";
        }
        
        /********************************* Start by dev ************************************/
        //Add Permistion 'Able to see tasks for following user '
	    
        $all_permission = Mage::getSingleton('core/session')->getAllpermission();
        
        if(in_array(1,$all_permission))
        {
            $user = Mage::getSingleton('admin/session');
            $userId = $user->getUser()->getUserId();
            
            $user_role = Mage::getSingleton('admin/session')->getUser();
             //Get the role id of the user
            $roleId = implode('', $user_role->getRoles());
            
            //Get the role name
            $roleName = Mage::getModel('admin/roles')->load($roleId)->getRoleName();
            
            $temptableOrganiger = Mage::getSingleton('core/resource')->getTableName('organizer_task');
            
            $user = Mage::getSingleton('core/session')->getRemoveuser();
            $user = rtrim($user,',');
            $user = ltrim($user,' ');
            
           if($roleName == 'Administrators' and $user != '')
           // $sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."')";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."')");
            
            else if($roleName == 'Administrators')
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."'";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."'");
	    else
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user = '".$userId."' AND ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."'";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_target_user = '".$userId."' AND ot_deadline = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_created_at = '".$prev_year.'-'.$prev_month.'-'.$currentday3."' OR ot_notify_date = '".$prev_year.'-'.$prev_month.'-'.$currentday3."'");
		
            $chkOrganiger = $connectionRead->fetchAll($sqlOrganiger);
            
            foreach($chkOrganiger as $task)
            {
                if($k < 5)
                {
                  $calendar1[$currentDay] .= '<div style="text-align: left;"> -- '.$task['ot_caption'].'</div> ';
                }
                $k++;
            }
        }
        /********************************* End by dev ************************************/
        
        

          // Seventh column (Saturday) reached. Start a new row.

          if ($dayOfWeek == 7) {

               $dayOfWeek = 0;
               $calendar .= "</tr><tr>";

          }
          //print_r($show_id);
          $currentDayRel = str_pad($currentday3, 2, "0", STR_PAD_LEFT);
    
          $currentMonthRel = str_pad($prev_month, 2, "0", STR_PAD_LEFT);
          
          $date = "$prev_year-$currentMonthRel-$currentDayRel";
          
          
            if($holyday[$date] != '')
            $css = 'holiday';
            else
            $css = '';
            
        
            
          if($todays_date==$currentDay && $current_month==$prev_month)
          {
            
            
            
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentday3.'" rel="'.$date.'"><div style="position:relative;  width:100%; height:100%;"><span id="dt__'.$currentday3.'" onclick="sc_open_pop(this.id);" class="ddc activated_day '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentday3.'\');">'.$currentday3.'</span>';
                $i=1;
                $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $date)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $date)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $date)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="even" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentday3.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentday3.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek1].', '.$monthName1.' '.$currentday3.'</strong></span><span style="float: right;" onclick="close_expan()">X</span></div>';
                    
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $date)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $date)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $date)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            $last = $i;
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="even"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                       
                    }
                    $calendar .= '</div>';
                }
                 if($holyday[$date] != '')
                    $calendar .=$holyday[$date]; 
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentday3.'" onclick="addtask('.$prev_month.','.$prev_year.','.$currentday3.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentday3.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentday3.'">
                        <div class="cross" id="sc_cr__'.$currentday3.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                               $calendar .= '<div>Organiger Task</div>';  
                                foreach($chkOrganiger as $task)
                                {
                                    if($task['ot_created_at'] == $date)
                                    $msg = 'Created ';
                                    else if($task['ot_notify_date'] == $date)
                                    $msg = 'Notify  ';
                                    else if($task['ot_deadline'] == $date)
                                    $msg = 'Complte  ';
                                    else
                                    $msg = '';
                    
                                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                    
                                    <div class="desc">      '.$task['ot_description'].'</div>';
                                    
                                }
                         
                
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    //$sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
							->from($temptableSaleOrder, array('created_at'))
							->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                    try {
                                        $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                        
                                     
                                     
                                     </div>';
                                     
                                     $ctctct++;
                                   }
                                   
                                  
                $calendar .='</div></div></div>';
                                  
            $calendar .='
                                   
                                    
            
            
            </div>
            
            </td>';  
          }
          else
          {
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentday3.'" rel="'.$date.'"><div style="position:relative; width:100%; height:100%;">1<span class="ddc '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentday3.'\');">'.$currentday3.'</span>';
            
                   
                    $i=1;
                    $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $date)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $date)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $date)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="even" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentday3.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentday3.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek1].', '.$monthName1.' '.$currentday3.'</strong></span><span style="float: right;cursor : pointer;" onclick="close_expan();">X</span></div>';
                    $i = 1;
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $date)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $date)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $date)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="even"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';

                    }
                    $calendar .= '</div>';
                }
                if($holyday[$date] != '')
                $calendar .=$holyday[$date];
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentday3.'" onclick="addtask('.$prev_month.','.$prev_year.','.$currentday3.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentday3.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentday3.'">
                        <div class="cross" id="sc_cr__'.$currentday3.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                     $calendar .= '<div>Organiger Task</div>';
                               
                                                               
                foreach($chkOrganiger as $task)
                {
                    if($task['ot_created_at'] == $date)
                    $msg = 'Created ';
                    else if($task['ot_notify_date'] == $date)
                    $msg = 'Notify  ';
                    else if($task['ot_deadline'] == $date)
                    $msg = 'Complte  ';
                    else
                    $msg = '';
                    
                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                            
                                            <div class="desc">      '.$task['ot_description'].'</div>';
                    
                }
                
                
                                
                           
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                    
                                    
                                      
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    //$sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
							->from($temptableSaleOrder, array('created_at'))
							->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                    try {
                                        $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                        
                                    
                                    
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                     
                                     
                                     </div>';
                                     $ctctct++;
                                   }
                                   
                                
                                    
                $calendar .='</div></div></div>';
           
                
                
            $calendar .='
                                   
                                    
            
            
            
            
            </div>
            
            
            
            </td>';  
          }
          

          // Increment counters
 
          }
     }
     
     $month = str_pad($month, 2, "0", STR_PAD_LEFT);
  
     while ($currentDay <= $numberDays) {
        
        
        $start_time=date("Y-m-d H:i:s",mktime(0,0,0,$month,$currentDay,$year));
        $end_time=date("Y-m-d H:i:s",mktime(23,59,59,$month,$currentDay,$year));
        
        if($currentDay < 10)
         $currentDay1 = '0'.$currentDay;
         else
         $currentDay1 = $currentDay;
         
        
        //All query Start
    
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
       // $sqlSaleOrder="SELECT count(entity_id) as ctct FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
                        ->from($temptableSaleOrder, array('count(entity_id) as ctct'))
                        ->where("created_at between '".$start_time."' and '".$end_time."'");
        try {
            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
            
        
        
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $tot_order_placed=0;
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $tot_order_placed= $res_chkSaleOrder["ctct"];
           
           
        }
        
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
        //$sqlSaleOrder="SELECT entity_id FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
                        ->from($temptableSaleOrder, array('entity_id'))
                        ->where("created_at between '".$start_time."' and '".$end_time."'");
        try {
            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $ord_id=array();
        $show_id=array();
        
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $ord_id[]=$res_chkSaleOrder["entity_id"];
           $show_id[]=str_pad($res_chkSaleOrder["entity_id"],9,"100000000",STR_PAD_LEFT);
           
           
        }
        
        if(count($ord_id)>0)
        {
            $clclcl="active_view";
        }
        else
        {
            $clclcl="";
        }
        
        /********************************* Start by dev ************************************/
        //Add Permistion 'Able to see tasks for following user '
	    
        $all_permission = Mage::getSingleton('core/session')->getAllpermission();
        
        if(in_array(1,$all_permission))
        {
            $user = Mage::getSingleton('admin/session');
            $userId = $user->getUser()->getUserId();
            
            $user_role = Mage::getSingleton('admin/session')->getUser();
             //Get the role id of the user
            $roleId = implode('', $user_role->getRoles());
            
            //Get the role name
            $roleName = Mage::getModel('admin/roles')->load($roleId)->getRoleName();
            
            $temptableOrganiger = Mage::getSingleton('core/resource')->getTableName('organizer_task');
            
            $user = Mage::getSingleton('core/session')->getRemoveuser();
            $user = rtrim($user,',');
            $user = ltrim($user,' ');
            
           if($roleName == 'Administrators' and $user != '')
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."')";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."')");
		
            else if($roleName == 'Administrators')
           //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."'";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."'");
            
            else
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user = '".$userId."' AND ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."'";
            $sqlOrganiger = $connectionRead->select()
                        ->from($temptableOrganiger, array('*'))
                        ->where("ot_target_user = '".$userId."' AND ot_deadline = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_created_at = '".$year.'-'.$month.'-'.$currentDay1."' OR ot_notify_date = '".$year.'-'.$month.'-'.$currentDay1."'");
            
            $chkOrganiger = $connectionRead->fetchAll($sqlOrganiger);
            
            foreach($chkOrganiger as $task)
            {
                if($k < 5)
                {
                  $calendar1[$currentDay] .= '<div style="text-align: left;"> -- '.$task['ot_caption'].'</div> ';
                }
                $k++;
            }
        }
        /********************************* End by dev ************************************/
        
        

          // Seventh column (Saturday) reached. Start a new row.

          if ($dayOfWeek == 7) {

               $dayOfWeek = 0;
               $calendar .= "</tr><tr>";

          }
          //print_r($show_id);
          $currentDayRel = str_pad($currentDay, 2, "0", STR_PAD_LEFT);
          
          $date = "$year-$month-$currentDayRel";
          
            //if($holyday[$year.'-'.$month.'-'.$currentDay1] != '')
            //$css = 'holiday';
            //else
            //$css = '';
            //
            //
            
          if($todays_date==$currentDay && $current_month==$month)
          {
            
            
            
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentDay.'" rel="'.$date.'"><div style="position:relative;  width:100%; height:100%;"><span id="dt__'.$currentDay.'" onclick="sc_open_pop(this.id);" class="ddy activated_day '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentDay.'\');">'.$currentDay.'</span>';
                $i=1;
                $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="odd" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentDay.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentDay.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek].', '.$monthName.' '.$currentDay1.'</strong></span><span style="float: right;" onclick="close_expan()">X</span></div>';
                    
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            if($i%2 == 0)
                            $css1 = 'class="even"';
                            else
                            $css1 = 'class="odd"';
                            $last = $i;
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="odd"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                       
                    }
                    $calendar .= '</div>';
                }
                if($holyday[$date] != '')
                $calendar .=$holyday[$date];
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentDay.'" onclick="addtask('.$month.','.$year.','.$currentDay.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentDay.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentDay.'">
                        <div class="cross" id="sc_cr__'.$currentDay.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                               $calendar .= '<div>Organiger Task</div>';  
                                foreach($chkOrganiger as $task)
                                {
                                    if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                                    $msg = 'Created ';
                                    else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                                    $msg = 'Notify  ';
                                    else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                                    $msg = 'Complte  ';
                                    else
                                    $msg = '';
                    
                                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                    
                                    <div class="desc">      '.$task['ot_description'].'</div>';
                                    
                                }
                           
                
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    //$sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
                                                ->from($temptableSaleOrder, array('created_at'))
                                                ->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                                
				    try {
					  $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                          
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                        
                                     
                                     
                                     </div>';
                                     
                                     $ctctct++;
                                   }
                                   
                                  
                $calendar .='</div></div></div>';
                                  
            $calendar .='
                                   
                                    
            
            
            </div>
            
            </td>';  
          }
          else
          {
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentDay.'" rel="'.$date.'"><div style="position:relative; width:100%; height:100%;">2<span class="ddy '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentDay.'\');">'.$currentDay.' Load</span>';
            
                   
                    $i=1;
                    $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="odd" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentDay.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentDay.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek].', '.$monthName.' '.$currentDay1.'</strong></span><span style="float: right;cursor : pointer;" onclick="close_expan();">X</span></div>';
                    $i = 1;
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            if($i%2 == 0)
                            $css1 = 'class="even"';
                            else
                            $css1 = 'class="odd"';
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="odd"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';

                    }
                    $calendar .= '</div>';
                }
               
                if($holyday[$date] != '')
                $calendar .=$holyday[$date];
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentDay.'" onclick="addtask('.$month.','.$year.','.$currentDay.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentDay.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentDay.'">
                        <div class="cross" id="sc_cr__'.$currentDay.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                     $calendar .= '<div>Organiger Task</div>';
                               
                                                               
                foreach($chkOrganiger as $task)
                {
                    if($task['ot_created_at'] == $year.'-'.$month.'-'.$currentDay1)
                    $msg = 'Created ';
                    else if($task['ot_notify_date'] == $year.'-'.$month.'-'.$currentDay1)
                    $msg = 'Notify  ';
                    else if($task['ot_deadline'] == $year.'-'.$month.'-'.$currentDay1)
                    $msg = 'Complte  ';
                    else
                    $msg = '';
                    
                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                            
                                            <div class="desc">      '.$task['ot_description'].'</div>';
                    
                }       
                           
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                    
                                    
                                      
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    // $sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
                                                ->from($temptableSaleOrder, array('created_at'))
                                                ->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                                
                                    try {
                                        $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                    
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                     
                                     
                                     </div>';
                                     $ctctct++;
                                   }
                                   
                                
                                    
                $calendar .='</div></div></div>';
           
                
                
            $calendar .='
                                   
                                    
            
            
            
            
            </div>
            
            
            
            </td>';  
          }
          

          // Increment counters
 
          $currentDay++;
          $dayOfWeek++;

     }
     
     

     // Complete the row of the last week in month, if necessary

     if ($dayOfWeek != 7) { 
     
          $remainingDays = 7 - $dayOfWeek;
          //$calendar .= "<td colspan='$remainingDays'>&nbsp;</td>";
          
          
            
          $dateComponents1 = getdate(mktime(0,0,0,$next_month,1,$next_year));
         $monthName1 = $dateComponents1['month'];
         
         for($predate = 0;$predate < $remainingDays;$predate++)
          {
           $currentday3 = 01+$predate;
            $start_time=date("Y-m-d H:i:s",mktime(0,0,0,$next_month,$currentday3,$next_year));
        $end_time=date("Y-m-d H:i:s",mktime(23,59,59,$next_month,$currentday3,$next_year));
        
        $dateComponents1 = getdate(mktime(0,0,0,$next_month,$currentday3,$next_year));
         $monthName1 = $dateComponents1['month'];
         $dayOfWeek1 = $dateComponents1['wday'];
        
        
        //All query Start
    
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
        //$sqlSaleOrder="SELECT count(entity_id) as ctct FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
			->from($temptableSaleOrder, array('count(entity_id) as ctct'))
			->where("created_at between '".$start_time."' AND '".$end_time."'");
        try {
            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
            
        
        
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $tot_order_placed=0;
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $tot_order_placed= $res_chkSaleOrder["ctct"];
           
           
        }
        
        $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order');
       // $sqlSaleOrder="SELECT entity_id FROM ".$temptableSaleOrder." WHERE created_at between '".$start_time."' and '".$end_time."'";
        $sqlSaleOrder = $connectionRead->select()
			->from($temptableSaleOrder, array('entity_id'))
			->where("created_at between '".$start_time."' AND '".$end_time."'");
        try {
            $chkSaleOrder = $connectionWrite->fetchAll($sqlSaleOrder);
        
        } catch (Exception $e){
        //echo $e>getMessage();
        }
        
        $ord_id=array();
        $show_id=array();
        
        foreach($chkSaleOrder as $res_chkSaleOrder) 
        {
           $ord_id[]=$res_chkSaleOrder["entity_id"];
           $show_id[]=str_pad($res_chkSaleOrder["entity_id"],9,"100000000",STR_PAD_LEFT);
           
           
        }
        
        if(count($ord_id)>0)
        {
            $clclcl="active_view";
        }
        else
        {
            $clclcl="";
        }
        
        /********************************* Start by dev ************************************/
        //Add Permistion 'Able to see tasks for following user '
	    
        $all_permission = Mage::getSingleton('core/session')->getAllpermission();
        
        if(in_array(1,$all_permission))
        {
            $user = Mage::getSingleton('admin/session');
            $userId = $user->getUser()->getUserId();
            
            $user_role = Mage::getSingleton('admin/session')->getUser();
             //Get the role id of the user
            $roleId = implode('', $user_role->getRoles());
            
            //Get the role name
            $roleName = Mage::getModel('admin/roles')->load($roleId)->getRoleName();
            
            $temptableOrganiger = Mage::getSingleton('core/resource')->getTableName('organizer_task');
            
            $user = Mage::getSingleton('core/session')->getRemoveuser();
            $user = rtrim($user,',');
            $user = ltrim($user,' ');
            
           if($roleName == 'Administrators' and $user != '')
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."')";
            $sqlOrganiger = $connectionRead->select()
                                ->from($temptableOrganiger, array('*'))
                                ->where("ot_target_user NOT IN(".$user.") AND (ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."')");
            
            else if($roleName == 'Administrators')
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."'";
            $sqlOrganiger = $connectionRead->select()
                                ->from($temptableOrganiger, array('*'))
                                ->where("ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."'");
            else
            //$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user = '".$userId."' AND ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."'";
            $sqlOrganiger = $connectionRead->select()
                                ->from($temptableOrganiger, array('*'))
                                ->where("ot_target_user = '".$userId."' AND ot_deadline = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_created_at = '".$next_year.'-'.$next_month.'-'.$currentday3."' OR ot_notify_date = '".$next_year.'-'.$next_month.'-'.$currentday3."'");
             
            $chkOrganiger = $connectionRead->fetchAll($sqlOrganiger);
            
            foreach($chkOrganiger as $task)
            {
                if($k < 5)
                {
                  $calendar1[$currentDay] .= '<div style="text-align: left;"> -- '.$task['ot_caption'].'</div> ';
                }
                $k++;
            }
        }
        /********************************* End by dev ************************************/
        
        

          // Seventh column (Saturday) reached. Start a new row.

          if ($dayOfWeek == 7) {

               $dayOfWeek = 0;
               $calendar .= "</tr><tr>";

          }
          //print_r($show_id);
          $currentDayRel = str_pad($currentday3, 2, "0", STR_PAD_LEFT);
          $currentMonthRel = str_pad($next_month, 2, "0", STR_PAD_LEFT);
          
          $date = "$next_year-$currentMonthRel-$currentDayRel";
        
            if($holyday[$date] != '')
            $css = 'holiday';
            else
            $css = '';
            
        
            
          if($todays_date==$currentDay && $current_month==$next_month)
          {
            
            
            
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentday3.'" rel="'.$date.'"><div style="position:relative;  width:100%; height:100%;"><span id="dt__'.$currentday3.'" onclick="sc_open_pop(this.id);" class="ddc activated_day '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentday3.'\');">'.$currentday3.'</span>';
                $i=1;
                $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $date)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $date)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $date)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="even" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentday3.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentday3.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek1].', '.$monthName1.' '.$currentday3.'</strong></span><span style="float: right;" onclick="close_expan()">X</span></div>';
                    
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $date)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $date)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $date)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            
                            $last = $i;
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="even"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                       
                    }
                    $calendar .= '</div>';
                }
                if($holyday[$date] != '')
                $calendar .=$holyday[$date];
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentday3.'" onclick="addtask('.$next_month.','.$next_year.','.$currentday3.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentday3.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentday3.'">
                        <div class="cross" id="sc_cr__'.$currentday3.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                               $calendar .= '<div>Organiger Task</div>';  
                                foreach($chkOrganiger as $task)
                                {
                                    if($task['ot_created_at'] == $date)
                                    $msg = 'Created ';
                                    else if($task['ot_notify_date'] == $date)
                                    $msg = 'Notify  ';
                                    else if($task['ot_deadline'] == $date)
                                    $msg = 'Complte  ';
                                    else
                                    $msg = '';
                    
                                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                    
                                    <div class="desc">      '.$task['ot_description'].'</div>';
                                    
                                }
                           
                
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    //$sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
							->from($temptableSaleOrder, array('created_at'))
							->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                    try {
                                        $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                        
                                     
                                     
                                     </div>';
                                     
                                     $ctctct++;
                                   }
                                   
                                  
                $calendar .='</div></div></div>';
                                  
            $calendar .='
                                   
                                    
            
            
            </div>
            
            </td>';  
          }
          else
          {
            $calendar .= '<td class="sc_day '.$clclcl.'" id="sc_day_'.$currentday3.'" rel="'.$date.'"><div style="position:relative; width:100%; height:100%;">3<span class="ddc '.$css.'" onclick="sc_open_pop(\'sc_dt__'.$currentday3.'\');">'.$currentday3.'</span>';
            
                   
                    $i=1;
                    $last = 0;
                foreach($chkOrganiger as $task)
                {
                    if($i < 3)
                    {
                        if($task['ot_created_at'] == $date)
                        $msg = 'Created ';
                        else if($task['ot_notify_date'] == $date)
                        $msg = 'Notify  ';
                        else if($task['ot_deadline'] == $date)
                        $msg = 'Complte  ';
                        else
                        $msg = '';
                        
                        //if($i%2 == 0)
                        //$css1 = 'class="even"';
                        //else
                        //$css1 = 'class="odd"';
                        $last = $i;
                        $rgb = GreenYellowRed($task['ot_target_user']*20);
                        $calendar .= '<div class="even" style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';
                    }
                    
                    $i++;
                }
                
                if($i-$last-1 > 0)
                {
                    $calendar .= '<div class="more" style="text-align: left; cursor:pointer;" onclick="expand('.$currentday3.');"> + '.($i-$last-1).' more</div><div class="expand" id="expand_'.$currentday3.'">
                    
                    <div class="stickhead" ><span style="float: left;"><strong>'.$daysOfWeek[$dayOfWeek1].', '.$monthName1.' '.$currentday3.'</strong></span><span style="float: right;cursor : pointer;" onclick="close_expan();">X</span></div>';
                    $i = 1;
                    foreach($chkOrganiger as $task)
                    {
                      
                            if($task['ot_created_at'] == $date)
                            $msg = 'Created ';
                            else if($task['ot_notify_date'] == $date)
                            $msg = 'Notify  ';
                            else if($task['ot_deadline'] == $date)
                            $msg = 'Complte  ';
                            else
                            $msg = '';
                            
                            $rgb = GreenYellowRed($task['ot_target_user']*20);
                            $calendar .= '<div class="even"  style="text-align: left;cursor:pointer;background-color: rgb('.$rgb.');" onclick="edittask('.$task['ot_id'].');"> -- '.$msg.' '.$task['ot_caption'].'</div>';

                    }
                    $calendar .= '</div>';
                }
                if($holyday[$date] != '')
                $calendar .=$holyday[$date];
            
            $calendar .= '<div style="width:100%; height:100%;" id="sc_dt__'.$currentday3.'" onclick="addtask('.$next_month.','.$next_year.','.$currentday3.')"></div>
            
                <div class="overlay" id="sc_ov__'.$currentday3.'"></div>
                    <div class="outer taskcl" id="sc_ou__'.$currentday3.'">
                        <div class="cross" id="sc_cr__'.$currentday3.'" onclick="sc_close_pop(this.id);">X</div>
                        <div class="inner">
                            
                            ';
                     $calendar .= '<div>Organiger Task</div>';
                               
                                                               
                foreach($chkOrganiger as $task)
                {
                    if($task['ot_created_at'] == $date)
                    $msg = 'Created ';
                    else if($task['ot_notify_date'] == $date)
                    $msg = 'Notify  ';
                    else if($task['ot_deadline'] == $date)
                    $msg = 'Complte  ';
                    else
                    $msg = '';
                    
                    $taskModule = Mage::getModel('Organizer/Task')->load($task['ot_id']);
                    $calendar .= '<div style="text-align: left;"><a href="'.$taskModule->getEntityLink().'" target="_blank"> -- '.$msg.' '.$task['ot_caption'].'</a></div>
                                            
                                            <div class="desc">      '.$task['ot_description'].'</div>';
                    
                }       
                           
                $calendar .='<div class="tot_ord_det">';
                                    $ctctct=0;
                                    
                                    
                                      
                                   foreach($show_id as $vvl)
                                   {
                                    //print_r($show_id);
                                    $Order = Mage::getModel('sales/order')->load($ord_id[$ctctct]);
                                    // print_r($Order);
                                     
                                    $CustomerAdrId=$Order['shipping_address_id'];
                                    $address = Mage::getModel('sales/order_address')->load($CustomerAdrId);
                         
                                    $Street = $address['street'];
                                    $city = $address['city'];
                                    $region = $address['region'];
                                    $PostCode = $address['postcode'];
                                    $country_code = $address['country_id'];
                                    $countryModel = Mage::getModel('directory/country')->load($country_code);
                                    $country_name = $countryModel->getName();
                                     
                                    $temptableSaleOrder=Mage::getSingleton('core/resource')->getTableName('sales_flat_order_status_history');
                                    //$sqlSaleOrder="SELECT created_at FROM ".$temptableSaleOrder." WHERE entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'";
                                    $sqlSaleOrder = $connectionRead->select()
							->from($temptableSaleOrder, array('created_at'))
							->where("entity_name='shipment' and parent_id='".$ord_id[$ctctct]."'");
                                    try {
                                            $chkSaleOrder = $connectionRead->fetchAll($sqlSaleOrder);
                                    
                                    
                                    
                                    } catch (Exception $e){
                                    //echo $e>getMessage();
                                    }
                                    
                                    $ord_pay_dt="";
                                    foreach($chkSaleOrder as $res_chkSaleOrder) 
                                    {
                                       $ord_pay_dt= $res_chkSaleOrder["created_at"];
                                       
                                       
                                    }
                                     
                                     
                                     
                                    
                                     
                                    // exit;
                                     
                                     $calendar .='<div class="ord_lnk"><a target="_blank" href="'.Mage::getBaseUrl()."/admin/sales_order/view/order_id/".$ord_id[$ctctct].'">Order : '.$vvl.'</a>
                                     
                                     
                                        <div class="bil_ship_con"><span>Shipping Country : </span>
                                            '.$country_name.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Shipping State : </span>
                                            '.$region.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Order payment date : </span>
                                            '.$ord_pay_dt.'
                                            
                                        </div>
                                        <div class="bil_ship_state"><span>Delivery Deadline : </span>
                                            
                                            
                                        </div>
                                        
                                     
                                     
                                     </div>';
                                     $ctctct++;
                                   }
                                   
                                
                                
                                    
                $calendar .='</div></div></div>';
           
                
                
            $calendar .='
                                   
                                    
            
            
            
            
            </div>
            
            
            
            </td>';  
          }
          

          // Increment counters
 
          }


     }
     
     $calendar .= "</tr>";

     $calendar .= "</table><input type='hidden' id='nowdate' value='".$year.'-'.$month.'-'.$currentDay1."'/><input type='hidden' id='catformat' value='".Mage::getSingleton('core/session')->getFormattype()."'/>";

     return $calendar;

}
?>

<script type="text/javascript" src="<?php echo $this->getJsUrl().'calendar.js';?>"></script>
<script type="text/javascript" src="<?php echo $this->getJsUrl().'worldclock.js';?>"></script>
<script type="text/javascript">
window.onload=worldClockZone;
</script>



<style type="text/css">
.hrow {
font-weight:bold;
color: #C1E97C;
}
.hrow td{
padding-top: 20px;
width: 140px;
}
</style>
<?php

     $dateComponents = getdate();

     $month = $dateComponents['mon']; 			     
     $year = $dateComponents['year'];
     $dateArray=Array();
     
    $temptableHoliday=Mage::getSingleton('core/resource')->getTableName('holiday');
    //$sqlHoliday="SELECT * FROM ".$temptableHoliday." GROUP BY country_name";
    $sqlHoliday = $connectionRead->select()
                    ->from($temptableHoliday, array('*'))
                    ->group('country_name');
    $chkHoliday = $connectionRead->fetchall($sqlHoliday);
    
    $countryh = '<div class="othercal">Other Calendar</div>';
    
    foreach($chkHoliday as $holicountry)
    {
        $img = '';
      if(!strpos(Mage::getSingleton('core/session')->getRemoveholi(),$holicountry['country_name']))
      $img = '<span style="float: right;"><img src="'.Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_SKIN).'adminhtml/default/default/images/tick_icon.gif"/></span>';
      
        $countryh .= '<div class="countryh" onclick="chkholi(\''.$holicountry['country_name'].'\',\''.$month.'\',\''.$year.'\',\''.Mage::getSingleton('core/session')->getFormattype().'\')" style="cursor:pointer;"><div style="background-color: '.$holicountry['color'].';width: 11px;height: 12px;" class="colorbox"></div><div class="countryN" style="float: left;width: 122px;">'.$holicountry['country_name'].'</div>'.$img.'</div>';
    }
    
    //Add Permistion 'Able to add tasks on calander of following members'
	    
    $all_permission = Mage::getSingleton('core/session')->getAllpermission();
    
    if(in_array(31,$all_permission))
    {
     echo '<div class="wcal"><script type="text/javascript">document.write(dispCal(0,0));</script></div>';
    }
    
     
     /********************** For My Calender ******************************/
     //Add Permistion 'Able to see tasks for following user '
	    
    $all_permission = Mage::getSingleton('core/session')->getAllpermission();
    
    if(in_array(1,$all_permission) and !in_array(2,$all_permission))
    {
            $user_role = Mage::getSingleton('admin/session')->getUser();
            //Get the role id of the user
           $roleId = implode('', $user_role->getRoles());
           
           //Get the role name
           $roleName = Mage::getModel('admin/roles')->load($roleId)->getRoleName();
                
            if($roleName == 'Administrators')
            {
                
             
                $my_cal = '<div class="othercal">My Calendar</div>';
                $adminUserModel = Mage::getModel('admin/user');
                $userCollection = $adminUserModel->getCollection()->load();
                foreach($userCollection as $user)
                {
                    $output = "";
                    if(strpos(Mage::getSingleton('core/session')->getRemoveuser(),$user->getId()))
                     $rgb = 'f,f,f';
                     else
                     $rgb = GreenYellowRed($user->getId()*20);
                    
                   
                    $output .= "<div style='background-color: rgb($rgb);width:12px;height:12px;border:1px solid #ccc;'></div>";
                    $my_cal .= '<div class="my_cal" onclick="chkuser('.$user->getId().',\''.Mage::getSingleton('core/session')->getFormattype().'\');">'.$output.'<div class="calname">'.$user->getName().'</div></div>';
                }
            }
    }
     /********************** For My Calender ******************************/
     
     //echo '<div id="sc_cal_out" style="width: 85%; float:left" ><div class="calt" style="margin-top: 29px;">'.$my_cal.'</div><div class="countryt" style="margin-top: 29px;">'.$countryh.'</div><div class="maincal">'.scheduler_calendar ($month,$year,$dateArray).'</div></div>';
     
     echo '<div id="sc_cal_out" style="width: 85%; float:left" ><div class="calt" style="margin-top: 29px;">'.$my_cal.'</div><div class="countryt" style="margin-top: 29px;">'.$countryh.'</div><div class="maincal" id="maincal">'.scheduler_calendar ($month,$year,$dateArray).'</div></div>';


$user = Mage::getSingleton('admin/session');
$userId = $user->getUser()->getUserId();

$user_role = Mage::getSingleton('admin/session')->getUser();
 //Get the role id of the user
$roleId = implode('', $user_role->getRoles());

//Get the role name
$roleName = Mage::getModel('admin/roles')->load($roleId)->getRoleName();

$temptableOrganiger = Mage::getSingleton('core/resource')->getTableName('organizer_task');

if($roleName == 'Administrators')
//$sqlOrganiger="SELECT * FROM ".$temptableOrganiger;
$sqlOrganiger = $connectionRead->select()
                ->from($temptableOrganiger, array('*'));
else
//$sqlOrganiger="SELECT * FROM ".$temptableOrganiger." WHERE ot_target_user = '".$userId."' ";
$sqlOrganiger = $connectionRead->select()
                ->from($temptableOrganiger, array('*'))
                ->where('ot_target_user=?', $userId);
$chkOrganiger1 = $connectionRead->fetchAll($sqlOrganiger);

?>


<script type="text/javascript">


    function onKeyPressed(ev,element) {
   var e = ev || event;
   var id = element.split('_');
   if(e.keyCode == 13 || e.keyCode == 40) {
      //Enter was pressed
      //alert(document.getElementById('todobody').style.marginTop);
      
      if(document.getElementById('row_'+id[1]).style.marginTop != '300px' && document.getElementById(element).value == '')
        {
            var value = document.getElementById('row_'+id[1]).style.marginTop.split('px');
            document.getElementById('row_'+id[1]).style.marginTop = (parseInt(value[0]) + parseInt(20)) +'px';
            return false; //prevents form from being submitted.
        }
        else{
            
            document.getElementById('todobody').innerHTML = document.getElementById('todobody').innerHTML+'<div id="row_'+(parseInt(id[1])+1)+'" style="margin-top:0px;"><input type="checkbox"/><input onkeyup="onKeyPressed(event,this.id)" type="text" id="todo_'+(parseInt(id[1])+1)+'" style="width: 105px;border:0"/><span style="cursor:pointer;"><img src="<?php echo $this->getSkinUrl().'images/greater.png'?>" id="img_'+(parseInt(id[1])+1)+'" onclick="addtodo(this.id)"/></span></div>';
        }
   }
   else if(e.keyCode == 38)
   {
        if(document.getElementById('row_'+id[1]).style.marginTop != '0px')
        {
            var value = document.getElementById('row_'+id[1]).style.marginTop.split('px');
          document.getElementById('row_'+id[1]).style.marginTop = (parseInt(value[0]) - parseInt(20)) +'px';
          return false; //prevents form from being submitted.
        }
   }
}

function deletetodo()
{
    var k = 1;
    var todo = '';
    while(document.getElementById('todoid_'+k))
    {
        if(document.getElementById('todoid_'+k).checked)
        {
            //alert(document.getElementById('todoid_'+k).value);
            todo += document.getElementById('todoid_'+k).value + '_';
            
        }
        k++;
        
    }
    
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            //alert(xmlhttp.responseText);
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
          loadtodo();
        }
      }
      
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/deletetodo/?todo="+todo+"&form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}


function switchlist()
{
    if(document.getElementById("switchlist").style.display == "none")
     document.getElementById("switchlist").style.display="block";
     else
     document.getElementById("switchlist").style.display="none";
}
function openList()
{
    document.getElementById("switchlist").style.display="none";
   var listname = prompt("Create a new list named :","");
   
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            var str = xmlhttp.responseText.split('@');
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            document.getElementById('todobody').innerHTML = str[0];
            document.getElementById('todohead').innerHTML = str[1];
            document.getElementById('alltask').innerHTML = str[2];
            document.getElementById("addlist").style.display="none";

        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/todolist/?listname="+listname+"&form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}

function listload(listid)
{
   document.getElementById("switchlist").style.display="none";
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            //alert(xmlhttp.responseText);
            var str = xmlhttp.responseText.split('@');
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            document.getElementById('todobody').innerHTML = str[0];
            document.getElementById('todohead').innerHTML = str[1];
            document.getElementById('alltask').innerHTML = str[2];
        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/todolist/?listid="+listid+"&form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}

function listdelete()
{
   document.getElementById("switchlist").style.display="none";
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            //alert(xmlhttp.responseText);
            var str = xmlhttp.responseText.split('@');
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            document.getElementById('todobody').innerHTML = str[0];
            document.getElementById('todohead').innerHTML = str[1];
            document.getElementById('alltask').innerHTML = str[2];
        }
      }
    form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/todolistdelete/?form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}
function listrename()
{
    document.getElementById("switchlist").style.display="none";
   listname=prompt("Rename list","");
   
  
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            //alert(xmlhttp.responseText);
            var str = xmlhttp.responseText.split('@');
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            document.getElementById('todohead').innerHTML = str[0];
            document.getElementById('alltask').innerHTML = str[1];
        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/todorename/?listname="+listname+"&form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}
function complete(id)
{
    document.getElementById("switchlist").style.display="none";
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            //alert(xmlhttp.responseText);
            var str = xmlhttp.responseText.split('@');
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            //document.getElementById('todohead').innerHTML = str[0];
            //document.getElementById('alltask').innerHTML = str[1];
        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/todocomplete/?id="+id+"&form_key="+form_key+"&isAjax=true",true);
    xmlhttp.send();
}
function chkuser(userid,type)
{
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
           // alert(xmlhttp.responseText);
            //var str = xmlhttp.responseText.split('@');
            var date = document.getElementById('nowdate').value.split('-');
            sc_loadXMLDoc(date[1],date[0],'',date[2],type);
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            //document.getElementById('todohead').innerHTML = str[0];
            //document.getElementById('alltask').innerHTML = str[1];
        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/chkuser/?userid="+userid+"&form_key="+form_key+"&isAjax=true",true);
    
    xmlhttp.send();
}

function chksku(productid,type)
{
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
           //alert(xmlhttp.responseText);
            //var str = xmlhttp.responseText.split('@');
            var date = document.getElementById('nowdate').value.split('-');
            sc_loadXMLDoc(date[1],date[0],'',date[2],type);
           // document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
           // document.getElementById('extent_id').value = '';
            //document.getElementById('todohead').innerHTML = str[0];
            //document.getElementById('alltask').innerHTML = str[1];
        }
      }
      form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
    xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/chkproduct/?productid="+productid+"&form_key="+form_key+"&isAjax=true",true);
    
    xmlhttp.send();
}
</script>
<?php

$collection = Mage::getResourceModel('sales/order_collection')
                ->addAttributeToSelect('*')
                ->addAttributeToSort('created_at', 'desc');
$orderdata = '';
foreach ($collection as $col) {
        $orderdata .=  '{ value:'.$col->getId().', label: '.$col->getIncrementId().'},';
}

$tableQuote=Mage::getSingleton('core/resource')->getTableName('quotation');
//$sql = "SELECT * FROM ".$tableQuote." ORDER BY created_time DESC";
$sql = $connectionRead->select()
           ->from($tableQuote, array('*'))
           ->order('created_time','DESC');
$connection1 = $connectionRead->fetchAll($sql);
$quotedata = '';
foreach ($connection1 as $col1) {
         $quotedata .=  '{ value:'.$col1['quotation_id'].', label: '.$col1['increment_id'].'},';
}

$collectionPro = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('name');
$productdata = '';
foreach ($collectionPro as $pro) {
        $productdata .=  '{ value:'.$pro->getId().', label: "'.addslashes($pro->getName()).'"},';
}

                              
?>
<link rel="stylesheet" href="<?php echo $this->getJsUrl()?>jquery-ui.css" />
<!--script src="<?php //echo $this->getJsUrl()?>jquery-1.9.1.js"></script-->
<!--script type="text/javascript" >jQuery.noConflict();</script-->
<!--script src="<?php //echo $this->getJsUrl()?>jquery-ui.js"></script-->
<script>

 jQuery(function() {
        
    var projects = [
      <?php echo $orderdata;?>
    ];
    
    var quote = [
      <?php echo $quotedata;?>
    ];
    
var product = [
      <?php echo $productdata;?>
    ];
 
    jQuery( "#order" ).autocomplete({
      minLength: 0,
      source: projects,
      focus: function( event, ui ) {
        jQuery( "#order" ).val( ui.item.label );
        return false;
      },
      select: function( event, ui ) {
        jQuery( "#order" ).val( ui.item.label );
       
 
        return false;
      }
    })
    
jQuery( "#quote" ).autocomplete({
      minLength: 0,
      source: quote,
      focus: function( event, ui ) {
        jQuery( "#quote" ).val( ui.item.label );
        return false;
      },
      select: function( event, ui ) {
        jQuery( "#quote" ).val( ui.item.label );
       
 
        return false;
      }
    })

jQuery( "#product" ).autocomplete({
      minLength: 0,
      source: product,
      focus: function( event, ui ) {
        jQuery( "#product" ).val( ui.item.label );
        return false;
      },
      select: function( event, ui ) {
        jQuery( "#product" ).val( ui.item.label );
       
 
        return false;
      }
    })
    .data( "ui-autocomplete" )._renderItem = function( ul, item ) {
      return jQuery( "<li>" )
        .append( "<a>" + item.label + "<br>"  + "</a>" )
        .appendTo( ul );
    };
  });
 </script>
<style>
.ui-autocomplete{
        top:203px !important;
        position:absolute;
        z-index : 999;
}
</style>
<div class="addtask" id="addtask" style="display:none;">
   <div class="addclose" onclick="closetask();">X</div>
   <div class="maindiv">
        <div class="tabletask" >
            
                                </script>
            <form id="edit_form_task_" name="edit_form_task_">
    <input type="hidden" id="ot_id" name="ot_id" value="">
    <input type="hidden" id="ot_entity_type" name="ot_entity_type" value="">
    <input type="hidden" id="ot_created_date" name="ot_created_date" value="">
    <input type="hidden" id="ot_entity_id" name="ot_entity_id" value="">
    <input type="hidden" id="ot_entity_description" name="ot_entity_description" value="">
    <input type="hidden" id="ot_event" name="ot_event"  >
    <input type="hidden" id="ot_time" name="ot_time"  >
    <input id="form_key" name="form_key" type="hidden" value="<?php echo Mage::getSingleton('core/session')->getFormKey() ?>" />
    <div style="margin-left: 30px; margin-top: 66px;" "=" id="div_edit_task_">

        <fieldset id="my-fieldset">
            <table cellspacing="0" border="0" style="width: 550px;" class="addtaskcls">
                <tbody><tr class="addtasktr">
                    <td class="label" width="18%">Entity</td>            	
                    <td class="input-ele" colspan="2">
                        <span>
                            <select name="entity_type" id="entity_type" onchange="checktype(this.value);">
                                <option value="">Select Task Type</div>
                                <option value="order">Order</div>
                                <option value="quote">Quote</div>
                                <option value="product">Product</div>
                            </select>
                        </span>
                        <span id="order_id" style="display:none;">
                                <?php/*?>
                            <select id="order" onchange="set_order();">
                                <option value="">Select Order</div>
                                <?php
                                    $collection = Mage::getResourceModel('sales/order_collection')
                                                    ->addAttributeToSelect('*')
                                                    ->addAttributeToSort('created_at', 'desc');
                                    foreach ($collection as $col) {
                                ?>
                                    <option value="<?php echo $col->getId()?>"><?php echo $col->getIncrementId()?></div>
                                <?php }?>
                            </select>
                            <?php */?>
                            <input type="text" id="order" name="order" onblur="set_order();"/>
                        </span>
                        <span id="quote_id" style="display:none;">
                                <?php /*?>
                            <select id="quote" onchange="set_quote();">
                                <option value="">Select Quote</div>
                                <?php
                                    $tableQuote=Mage::getSingleton('core/resource')->getTableName('quotation');
                                    $sql = "SELECT * FROM ".$tableQuote." ORDER BY created_time DESC";
                                    $connection1 = Mage::getSingleton('core/resource')->getConnection('core_read')->fetchAll($sql);
                                    foreach ($connection1 as $col1) {
                                ?>
                                    <option value="<?php echo $col1['quotation_id']?>"><?php echo $col1['increment_id']?></div>
                                <?php }?>
                            </select>
                            <?php */?>
                            <input type="text" id="quote" name="quote" onblur="set_quote();"/>
                        </span>
                        <span id="pro_id" style="display:none;">
                                <?php /*?>
                            <select id="product" onchange="set_product();">
                                <option value="">Select Product</div>
                                <?php
                                    $collectionPro = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('name');;
                                    foreach ($collectionPro as $pro) {
                                ?>
                                    <option value="<?php echo $pro->getId()?>"><?php echo $pro->getName()?></div>
                                <?php }?>
                            </select>
                            <?php */?>
                            <input type="text" id="product" name="product" onblur="set_product();"/>
                        </span>
                       
                    </td>
                    <td>Created at  </td>
                    <!--<td colspan="3" align="right">
                            <button onclick="SubmitForm('', '1');" class="scalable save" type="button"><span>Save</span></button>
                        </td>-->
                    </tr>
                    <tr class="addtasktr">
                        <td class="label" width="16%">Author</td>
                        <td class="input-ele" width="16%">
                        <select name="ot_author_user" id="ot_author_user">
                            <?php
                                $adminUserModel = Mage::getModel('admin/user');
                                $userCollection = $adminUserModel->getCollection()->load();
                                foreach($userCollection as $user)
                                {
                                    echo '<option value="'.$user->getId().'" >'.$user->getUsername().'</option>';
                                }
                            ?></select>                        </td>
                        <td class="label" width="16%">Notification Date</td>
                        <td class="input-ele" width="16%">
                            <input size="6" type="text" id="ot_notify_date" name="ot_notify_date" value="">
                            <img src="<?php echo $this->getSkinUrl('images/grid-cal.gif');?>" class="v-middle" id="img_ot_notify_date">
                            <script type="text/javascript">
                                Calendar.setup({
                                    inputField : document.getElementById('edit_form_task_').elements['ot_notify_date'],
                                    ifFormat : '%Y-%m-%e',
                                    button : document.getElementById('edit_form_task_').elements['img_ot_notify_date'],
                                    align : 'Bl',
                                    singleClick : true
                                });
                            </script>
                        </td>
                        
                        <td class="label" width="16%">Priority</td>
                        <td class="input-ele" width="16%" colspan="3"><select name="ot_priority" id="ot_priority"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></td>
                    </tr>
                    <tr class="addtasktr">
                        <td class="label" width="16%">Target</td>
                        <td class="input-ele" width="16%">
                        <select name="ot_target_user" id="ot_target_user">
                            <option value=""></option>
                            <?php
                                $adminUserModel = Mage::getModel('admin/user');
                                $userCollection = $adminUserModel->getCollection()->load();
                                foreach($userCollection as $user)
                                {
                                    echo '<option value="'.$user->getId().'" >'.$user->getUsername().'</option>';
                                }
                            ?>
                        </select>                                                        <input type="checkbox" value="1" name="notify_target" id="notify_target"> Notify                            </td>
                            <td class="label" width="16%">Dead line</td>
                            <td class="input-ele" width="16%">
                                <input size="6" type="text" id="ot_deadline" name="ot_deadline" value="">
                                <img src="<?php echo $this->getSkinUrl('images/grid-cal.gif');?>" class="v-middle" id="img_ot_deadline">
                                <script type="text/javascript">
                                    Calendar.setup({
                                        inputField : document.getElementById('edit_form_task_').elements['ot_deadline'],
                                        ifFormat : '%Y-%m-%e',
                                        button : document.getElementById('edit_form_task_').elements['img_ot_deadline'],
                                        align : 'Bl',
                                        singleClick : true
                                    });
                                </script>
                            </td>
                            <?php
            //Add Permistion 'Able to mark task as complete for folloing members'
	    
            $all_permission = Mage::getSingleton('core/session')->getAllpermission();
            
            if(in_array(7,$all_permission))
            {
                            ?>
                            <td class="label" width="16%">Complete</td>
                            <td class="input-ele" width="16%"><input type="checkbox" value="1" id="ot_finished" name="ot_finished"></td>
                            
            <?php
            }
            ?>
                       
                </tr>
                <tr>
                     <td class="label" width="16%"><?php echo $this->__('Task Type');?></td>
                        <td class="label" width="16%">
                            <select name="ot_type" id="ot_type">
                                <option value="">Select Task Type</option>
                                <option value="Chain" >Chain</option>
                                <option value="Independent" >Independent</option>
                            </select>
                        </td>
                </tr>
                <tr>
                     <td class="label" width="16%"><?php echo $this->__('Product');?></td>
                        <td class="label" width="16%" id="task_item">
                            <select name="ot_item" id="ot_item">
                                <option value="">Select Item</option>
                            </select>
                        </td>
                </tr>
                <tr id="number" style="display:none;" class="addtasktr">
                    <td class="label" width="16%"><?php echo $this->__('Complition Day From Order'); ?></td>
                    <td class="input-ele">
                        <input name="ot_day" id="ot_day"  />
                    </td>
                </tr>
                 
                <tr class="addtasktr">
                    <td class="label" width="16%">Caption</td>
                    <td class="input-ele" ><input type="text" name="ot_caption" id="ot_caption" value="" size="40"></td>
                </tr>
                <tr class="addtasktr">
                    <td class="label" width="16%">Description</td>
                    <td class="input-ele" ><textarea name="ot_description" id="ot_description" cols="60" rows="5"></textarea></td>
                    
                </tr>
                <tr class="addtasktrsave">
                    <td class="input-ele" colspan="7">
                            <button onclick="SubmitForm('', '1');" class="scalable save" type="button"><span>Save</span></button>
                        </td></tr>
            </tbody></table>
        </fieldset>
    </div>


</form>
        </div>
   </div>
</div>
<div class="addtask1" id="addtask1" style="display:none;">
   <div class="addclose" onclick="closetask1();">X</div>
   <div class="maindiv">
        <div class="tabletask" id="tabletask">
        </div>
   </div>
</div>
<input type="hidden" id="extent_id"/>
<input type="hidden" id="holi_id"/>
<div class="allover" id="allover" style="display:none;"></div>
<div class="totalrightcal">
<?php
//Add Permistion 
	    
$all_permission = Mage::getSingleton('core/session')->getAllpermission();

if(in_array(1,$all_permission) and in_array(29,$all_permission))
{

    if(!Mage::getSingleton('core/session')->getRemoveclock())
    {
        $user = Mage::getSingleton('admin/session');
        $userId = $user->getUser()->getUserId();

        $temptableClock=Mage::getSingleton('core/resource')->getTableName('clock');
        //$sqlClock="SELECT * FROM ".$temptableClock." WHERE user_id = '".$userId."'";
        $sqlClock = $connectionRead->select()
                        ->from($temptableClock, array('*'))
                        ->where('user_id=?',$userId);
        $chkClock = $connectionRead->fetchAll($sqlClock);
        $nowholi = '';
        
        foreach($chkClock as $clockid)
        {
            $nowholi .= "'".$clockid['clock_id']."',";
        }
        Mage::getSingleton('core/session')->setRemoveclock($nowholi);
    }
?>

    <div style="float:left;border:1px;width: 194px;margin-top: -196px;" class="righttop">
   <div class="todo" id="todo" >
    <div><strong>Task</strong></div>
        <div class="todohead" id="todohead" style="float:left;">
            <?php
                $user = Mage::getSingleton('admin/session');
                $temptableTodo1=Mage::getSingleton('core/resource')->getTableName('todotasklist');
                //$sqlTodo1="SELECT * FROM ".$temptableTodo1." WHERE active = 1 AND user_id = '".$userId."' ";
                $sqlTodo1 = $connectionRead->select()
                        ->from($temptableTodo1, array('*'))
                        ->where("active = 1 AND user_id = '".$userId."'");
                $chkTodo1 = $connectionRead->fetchAll($sqlTodo1);
                
                if($chkTodo1[0]['name'] != '')
                echo $chkTodo1[0]['name'];
                else                
                echo $user->getUser()->getName()."'s List";
                
                if(!Mage::getSingleton('core/session')->getListid())
                {
                    Mage::getSingleton('core/session')->setListid($chkTodo1[0]['list_id']);
                }
                
            ?>
        </div>
        <div class="todobody" id="todobody" style="float:left;margin-top:0px;">
            <?php
                $temptableTodo=Mage::getSingleton('core/resource')->getTableName('todolist');
                //$sqlTodo="SELECT * FROM ".$temptableTodo." WHERE user_id = '".$userId."' AND list_id = '".$chkTodo1[0]['list_id']."'";
                $sqlTodo = $connectionRead->select()
                        ->from($temptableTodo, array('*'))
                        ->where("user_id = '".$userId."' AND list_id = '".$chkTodo1[0]['list_id']."'");
                $chkTodo = $connectionRead->fetchAll($sqlTodo);
                
                $k=1;
                foreach($chkTodo as $todo)
                {
                    
                    $Task = Mage::getModel('Organizer/Task')->load($todo['ot_id']);
                    $checked = '';
                    
                    $complete_date = date("jS F Y", strtotime($Task->getOtDeadline()));
                    if($todo['complete'] == 1)
                    $checked = 'checked';
                    ?>
                        <div id="row_<?php echo $k?>" class="rowtodo" style="margin-top:0px;">
                            <input id="todoid_<?php echo $k;?>"  value="<?php echo $todo['ot_id'];?>" <?php echo $checked;?> onclick="complete(<?php echo $todo['ot_id'];?>);" type="checkbox"/><input id="todo_<?php echo $k?>" onkeyup="onKeyPressed(event,this.id)" value="<?php echo $Task->getOtCaption().'.......'.$complete_date?>" type="test" class="todoitem" style="width: 145px;border:0"/>
                            <span style="cursor:pointer;"><img src="<?php echo $this->getSkinUrl().'images/greater.png'?>" id="img_<?php echo $k?>" onclick="addtodo(<?php echo $todo['ot_id'];?>,<?php echo $k?>)"/></span>
                        </div>
                    <?php
                    $k++;
                }
            ?>
            <div id="row_<?php echo $k;?>" style="margin-top:0px;" class="rowtodo">
                <input type="checkbox"/><input class="todoitem" onkeyup="onKeyPressed(event,this.id)" type="text" id="todo_<?php echo $k;?>" style="width: 105px;border:0"/>
                <span style="cursor:pointer;"><img src="<?php echo $this->getSkinUrl().'images/greater.png'?>" id="img_<?php echo $k;?>" onclick="addtodo(' ',<?php echo $k?>)"/></span>
            </div>
        </div>
   </div>
   
</div>
    


<div id="todo_action">
    <div class="action_add">
        <div onclick="addtodo(' ',<?php echo $k?>);" style="cursor:pointer;">Add</div>
    </div>
    <div class="action_delete">
        <div onclick="deletetodo();" style="cursor:pointer;">Delete</div>
    </div>
    <div class="action_total">
        <div onclick="switchlist();" style="cursor:pointer;" class="change">change</div>
        <div id="switchlist" style="display:none;">
            <div onclick="listrename();" style="cursor:pointer;">Rename List</div>
            <div onclick="listdelete();" style="cursor:pointer;">Delete List</div>
            <div onclick="openList();" style="cursor:pointer;">New List</div>
            <div class="undo"></div>
            <div class="alltask" id="alltask">
            <?php
                $temptableTodo=Mage::getSingleton('core/resource')->getTableName('todotasklist');
                //$sqlTodo="SELECT * FROM ".$temptableTodo." WHERE user_id = '".$userId."'";
                $sqlTodo = $connectionRead->select()
                        ->from($temptableTodo, array('*'))
                        ->where('user_id=?',$userId);
                $chkTodos = $connectionRead->fetchAll($sqlTodo);
                
                foreach($chkTodos as $chkTodo)
                {
            ?>
                    <div onclick="listload(<?php echo $chkTodo['list_id'];?>);" style="cursor:pointer;" ><?php echo $chkTodo['name']?></div>
            <?php
                }
            ?>
            </div>
        </div>
    </div>
</div>
<?php
}

//Add Permistion 'Able to see World clock'
		    
$all_permission = Mage::getSingleton('core/session')->getAllpermission();

if(in_array(30,$all_permission))
{
?>
<div><strong>World Clock</strong></div>
<div class="wclockdiv" id="wclockdivedit">
    <table class="worldclock" id="worldclockedit">
    <!--<tr class="hrowhead">
    <td><strong>World Clock</strong></td>
    </tr>-->
    <tr class="hrow" id="tr_GMT" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_GMT'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>GMT<span id="GMT"></span></td>
    </tr>
    <tr class="hrow" id="tr_Vancouver" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vancouver'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Vancouver<span id="Vancouver"></span></td>
    </tr>
    <tr class="hrow" id="tr_SanFrancisco" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_SanFrancisco'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>San Francisco<span id="SanFrancisco"></span></td>
    </tr>
    <tr class="hrow" id="tr_Seattle" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Seattle'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Seattle<span id="Seattle"></span></td>
    </tr>
    
    <tr class="hrow" id="tr_LosAngeles" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_LosAngeles'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Los Angeles<span id="LosAngeles"></span></td>
    </tr>
    <tr class="hrow" id="tr_Denver" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Denver'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Denver<span id="Denver"></span></td>
    </tr>
    <tr class="hrow" id="tr_MexicoCity" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_MexicoCity'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Mexico City<span id="MexicoCity"></span></td>
    </tr>
    <tr class="hrow" id="tr_Houston" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Houston'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Houston<span id="Houston"></span></td>
    </tr>
    
    <tr class="hrow" id="tr_Minneapolis" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Minneapolis'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Minneapolis<span id="Minneapolis"></span></td>
    </tr>
    <tr class="hrow" id="tr_NewOrleans" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_NewOrleans'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>New Orleans<span id="NewOrleans"></span></td>
    </tr>
    <tr class="hrow" id="tr_Chicago" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Chicago'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Chicago<span id="Chicago"></span></td>
    </tr>
    <tr class="hrow" id="tr_Montgomery" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Montgomery'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Montgomery<span id="Montgomery"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Indianapolis" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Indianapolis'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Indianapolis<span id="Indianapolis"></span></td>
    </tr>
    <tr class="hrow" id="tr_Atlanta" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Atlanta'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Atlanta<span id="Atlanta"></span></td>
    </tr>
    <tr class="hrow" id="tr_Detroit" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Detroit'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Detroit<span id="Detroit"></span></td>
    </tr>
    <tr class="hrow" id="tr_Miami" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Miami'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Miami<span id="Miami"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_WashingtonDC" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_WashingtonDC'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Washington DC<span id="WashingtonDC"></span></td>
    </tr>
    <tr class="hrow" id="tr_Philadelphia" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Philadelphia'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Philadelphia<span id="Philadelphia"></span></td>
    </tr>
    <tr class="hrow" id="tr_NewYork" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_NewYork'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>New York<span id="NewYork"></span></td>
    </tr>
    <tr class="hrow" id="tr_Montreal" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Montreal'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Montreal<span id="Montreal"></span></td>
    </tr>
    
    
    
    <tr class="hrow" id="tr_Boston" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Boston'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Boston<span id="Boston"></span></td>
    </tr>
    <tr class="hrow" id="tr_BuenosAires" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_BuenosAires'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Buenos Aires<span id="BuenosAires"></span></td>
    </tr>
    <tr class="hrow" id="tr_SaoPaulo" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_SaoPaulo'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Sao Paulo<span id="SaoPaulo"></span></td>
    </tr>
    <tr class="hrow" id="tr_RioDeJaneiro" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_RioDeJaneiro'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Rio De Janeiro<span id="RioDeJaneiro"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Lisbon" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Lisbon'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Lisbon<span id="Lisbon"></span></td>
    </tr>
    <tr class="hrow" id="tr_Dublin" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Dublin'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Dublin<span id="Dublin"></span></td>
    </tr>
    <tr class="hrow" id="tr_London" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_London'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>London<span id="London"></span></td>
    </tr>
    <tr class="hrow" id="tr_Madrid" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Madrid'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Madrid<span id="Madrid"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Barcelona" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Barcelona'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Barcelona<span id="Barcelona"></span></td>
    </tr>
    <tr class="hrow" id="tr_Paris" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Paris'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Paris<span id="Paris"></span></td>
    </tr>
    <tr class="hrow" id="tr_Brussels" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Brussels'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Brussels<span id="Brussels"></span></td>
    </tr>
    <tr class="hrow" id="tr_Amsterdam" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Amsterdam'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Amsterdam<span id="Amsterdam"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Frankfurt" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Frankfurt'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Frankfurt<span id="Frankfurt"></span></td>
    </tr>
    <tr class="hrow" id="tr_Rome" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Rome'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Rome<span id="Rome"></span></td>
    </tr>
    <tr class="hrow" id="tr_Berlin" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Berlin'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Berlin<span id="Berlin"></span></td>
    </tr>
    <tr class="hrow" id="tr_Prague" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Prague'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Prague<span id="Prague"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Vienna" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vienna'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Vienna<span id="Vienna"></span></td>
    </tr>
    <tr class="hrow" id="tr_Stockholm" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Stockholm'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Stockholm<span id="Stockholm"></span></td>
    </tr>
    <tr class="hrow" id="tr_Athens" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Athens'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Athens<span id="Athens"></span></td>
    </tr>
    <tr class="hrow" id="tr_Helsinki" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Helsinki'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Helsinki<span id="Helsinki"></span></td>
    </tr>
    
    
    
    <tr class="hrow" id="tr_Minsk" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Minsk'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Minsk<span id="Minsk"></span></td>
    </tr>
    <tr class="hrow" id="tr_Istanbul" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Istanbul'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Istanbul<span id="Istanbul"></span></td>
    </tr>
    <tr class="hrow" id="tr_Cairo" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Cairo'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Cairo<span id="Cairo"></span></td>
    </tr>
    <tr class="hrow" id="tr_Jerusalem" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Jerusalem'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Jerusalem<span id="Jerusalem"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Beirut" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Beirut'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Beirut<span id="Beirut"></span></td>
    </tr>
    <tr class="hrow" id="tr_Moscow" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Moscow'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Moscow<span id="Moscow"></span></td>
    </tr>
    <tr class="hrow" id="tr_Baghdad" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Baghdad'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Baghdad<span id="Baghdad"></span></td>
    </tr>
    <tr class="hrow" id="tr_Dubai" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Dubai'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Dubai<span id="Dubai"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Bangkok" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Bangkok'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Bangkok<span id="Bangkok"></span></td>
    </tr>
    <tr class="hrow" id="tr_Jakarta" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Jakarta'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Jakarta<span id="Jakarta"></span></td>
    </tr>
    <tr class="hrow" id="tr_HongKong" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_HongKong'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Hong Kong<span id="HongKong"></span></td>
    </tr>
    <tr class="hrow" id="tr_Beijing" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Beijing'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Beijing<span id="Beijing"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Shanghai" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Shanghai'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Shanghai<span id="Shanghai"></span></td>
    </tr>
    <tr class="hrow" id="tr_Seoul" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Seoul'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Seoul<span id="Seoul"></span></td>
    </tr>
    <tr class="hrow" id="tr_Tokyo" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Tokyo'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Tokyo<span id="Tokyo"></span></td>
    </tr>
    <tr class="hrow" id="tr_Melbourne" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Melbourne'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Melbourne<span id="Melbourne"></span></td>
    </tr>
    
    
    <tr class="hrow" id="tr_Sydney" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Sydney'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Sydney<span id="Sydney"></span></td>
    </tr>
    <tr class="hrow" id="tr_Brisbane" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Brisbane'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Brisbane<span id="Brisbane"></span></td>
    </tr>
    <tr class="hrow" id="tr_Vladivostok" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vladivostok'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Vladivostok<span id="Vladivostok"></span></td>
    </tr>
    <tr class="hrow" id="tr_Kamchatka" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Kamchatka'))echo 'style="display:block;"';else echo 'style="display:none;"';?>>
    <td>Kamchatka<span id="Kamchatka"></span></td>
    </tr>
    
    
    </table>
</div>
<div id="settings" class="settings" onclick="chkseting();" style="cursor:pointer;">Settings</div>

<div class="wclockdiv" id="wclockdivedit1" style="display:none;margin-top: -302px;background-color: white;">
    <table class="worldclock" id="worldclockedit1">
    <tr class="hrowhead">
    <td><button onclick="backclock();" style="cursor:pointer;">Back</button></td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox" <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_GMT'))echo 'checked';?> value="tr_GMT"onclick="checkclock(this.value);"/>GMT</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vancouver'))echo 'checked';?> value="tr_Vancouver"onclick="checkclock(this.value);"/>Vancouver</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_SanFrancisco'))echo 'checked';?> value="tr_SanFrancisco"onclick="checkclock(this.value);"/>San Francisco</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Seattle'))echo 'checked';?> value="tr_Seattle" onclick="checkclock(this.value);"/>Seattle</td>
    </tr>
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_LosAngeles'))echo 'checked';?> value="tr_LosAngeles" onclick="checkclock(this.value);"/>Los Angeles</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Denver'))echo 'checked';?> value="tr_Denver" onclick="checkclock(this.value);"/>Denver</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_MexicoCity'))echo 'checked';?> value="tr_MexicoCity" onclick="checkclock(this.value);"/>Mexico City</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Houston'))echo 'checked';?> value="tr_Houston" onclick="checkclock(this.value);"/>Houston</td>
    </tr>
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Minneapolis'))echo 'checked';?> value="tr_Minneapolis" onclick="checkclock(this.value);"/>Minneapolis</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_NewOrleans'))echo 'checked';?> value="tr_NewOrleans" onclick="checkclock(this.value);"/>New Orleans</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Chicago'))echo 'checked';?> value="tr_Chicago" onclick="checkclock(this.value);"/>Chicago</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Montgomery'))echo 'checked';?> value="tr_Montgomery" onclick="checkclock(this.value);"/>Montgomery</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Indianapolis'))echo 'checked';?> value="tr_Indianapolis" onclick="checkclock(this.value);"/>Indianapolis</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Atlanta'))echo 'checked';?> value="tr_Atlanta" onclick="checkclock(this.value);"/>Atlanta</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Detroit'))echo 'checked';?> value="tr_Detroit" onclick="checkclock(this.value);"/>Detroit</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Miami'))echo 'checked';?> value="tr_Miami" onclick="checkclock(this.value);"/>Miami</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_WashingtonDC'))echo 'checked';?> value="tr_WashingtonDC" onclick="checkclock(this.value);"/>Washington DC</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Philadelphia'))echo 'checked';?> value="tr_Philadelphia" onclick="checkclock(this.value);"/>Philadelphia</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_NewYork'))echo 'checked';?> value="tr_NewYork" onclick="checkclock(this.value);"/>New York</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Montreal'))echo 'checked';?> value="tr_Montreal" onclick="checkclock(this.value);"/>Montreal</td>
    </tr>
    
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Boston'))echo 'checked';?> value="tr_Boston" onclick="checkclock(this.value);"/>Boston</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_BuenosAires'))echo 'checked';?> value="tr_BuenosAires" onclick="checkclock(this.value);"/>Buenos Aires</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_SaoPaulo'))echo 'checked';?> value="tr_SaoPaulo" onclick="checkclock(this.value);"/>Sao Paulo</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_RioDeJaneiro'))echo 'checked';?> value="tr_RioDeJaneiro" onclick="checkclock(this.value);"/>Rio De Janeiro</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Lisbon'))echo 'checked';?> value="tr_Lisbon" onclick="checkclock(this.value);"/>Lisbon</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Dublin'))echo 'checked';?> value="tr_Dublin" onclick="checkclock(this.value);"/>Dublin</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_London'))echo 'checked';?> value="tr_London" onclick="checkclock(this.value);"/>London</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Madrid'))echo 'checked';?> value="tr_Madrid" onclick="checkclock(this.value);"/>Madrid</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Barcelona'))echo 'checked';?> value="tr_Barcelona" onclick="checkclock(this.value);"/>Barcelona</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Paris'))echo 'checked';?> value="tr_Paris" onclick="checkclock(this.value);"/>Paris</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Brussels'))echo 'checked';?> value="tr_Brussels" onclick="checkclock(this.value);"/>Brussels</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Amsterdam'))echo 'checked';?> value="tr_Amsterdam" onclick="checkclock(this.value);"/>Amsterdam</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Frankfurt'))echo 'checked';?> value="tr_Frankfurt" onclick="checkclock(this.value);"/>Frankfurt</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Rome'))echo 'checked';?> value="tr_Rome" onclick="checkclock(this.value);"/>Rome</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Berlin'))echo 'checked';?> value="tr_Berlin" onclick="checkclock(this.value);"/>Berlin</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Prague'))echo 'checked';?> value="tr_Prague" onclick="checkclock(this.value);"/>Prague</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vienna'))echo 'checked';?> value="tr_Vienna" onclick="checkclock(this.value);"/>Vienna</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Stockholm'))echo 'checked';?> value="tr_Stockholm" onclick="checkclock(this.value);"/>Stockholm</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Athens'))echo 'checked';?> value="tr_Athens" onclick="checkclock(this.value);"/>Athens</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Helsinki'))echo 'checked';?> value="tr_Helsinki" onclick="checkclock(this.value);"/>Helsinki</td>
    </tr>
    
    
    
    <tr class="hrow1">
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Minsk'))echo 'checked';?> value="tr_Minsk" onclick="checkclock(this.value);"/>Minsk</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Istanbul'))echo 'checked';?> value="tr_Istanbul" onclick="checkclock(this.value);"/>Istanbul</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Cairo'))echo 'checked';?> value="tr_Cairo" onclick="checkclock(this.value);"/>Cairo</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Jerusalem'))echo 'checked';?> value="tr_Jerusalem" onclick="checkclock(this.value);"/>Jerusalem</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Beirut'))echo 'checked';?> value="tr_Beirut" onclick="checkclock(this.value);"/>Beirut</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Moscow'))echo 'checked';?> value="tr_Moscow" onclick="checkclock(this.value);"/>Moscow</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Baghdad'))echo 'checked';?> value="tr_Baghdad" onclick="checkclock(this.value);"/>Baghdad</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Dubai'))echo 'checked';?> value="tr_Dubai" onclick="checkclock(this.value);"/>Dubai</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Bangkok'))echo 'checked';?> value="tr_Bangkok" onclick="checkclock(this.value);"/>Bangkok</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Jakarta'))echo 'checked';?> value="tr_Jakarta" onclick="checkclock(this.value);"/>Jakarta</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_HongKong'))echo 'checked';?> value="tr_HongKong" onclick="checkclock(this.value);"/>Hong Kong</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Beijing'))echo 'checked';?> value="tr_Beijing" onclick="checkclock(this.value);"/>Beijing</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Shanghai'))echo 'checked';?> value="tr_Shanghai" onclick="checkclock(this.value);"/>Shanghai</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Seoul'))echo 'checked';?> value="tr_Seoul" onclick="checkclock(this.value);"/>Seoul</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Tokyo'))echo 'checked';?> value="tr_Tokyo" onclick="checkclock(this.value);"/>Tokyo</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Melbourne'))echo 'checked';?> value="tr_Melbourne" onclick="checkclock(this.value);"/>Melbourne</td>
    </tr>
    
    
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Sydney'))echo 'checked';?> value="tr_Sydney" onclick="checkclock(this.value);"/>Sydney</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Brisbane'))echo 'checked';?> value="tr_Brisbane" onclick="checkclock(this.value);"/>Brisbane</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Vladivostok'))echo 'checked';?> value="tr_Vladivostok" onclick="checkclock(this.value);"/>Vladivostok</td>
    </tr>
    <tr class="hrow1" >
    <td><input type="checkbox"  <?php if(strpos(Mage::getSingleton('core/session')->getRemoveclock(),'tr_Kamchatka'))echo 'checked';?> value="tr_Kamchatka" onclick="checkclock(this.value);"/>Kamchatka</td>
    </tr>
    
    
    </table>
</div>
</div>
<?php }?>

<div class="addholi" id="addholi" style="display:none;">
    <div class="addclose1" onclick="holiaddclose();">X</div>
    <div class="addholimain">
        <table class="addtasktab">
            <tr>
                <td>Country for holiday</td>
                <td>
                    <select id="addcountry">
                        <option >Select Country</option>
                        <?php
                            $temptableHoliday=Mage::getSingleton('core/resource')->getTableName('holiday');
                            //$sqlHoliday="SELECT * FROM ".$temptableHoliday." Group BY country_name";
                            $sqlHoliday = $connectionRead->select()
                                        ->from($temptableHoliday, array('*'))
                                        ->group('country_name');
                            $chkHoliday = $connectionRead->fetchall($sqlHoliday);
                            
                            foreach($chkHoliday as $holidays)
                            echo '<option value="'.$holidays['country_name'].'">'.$holidays['country_name'].'</option>';
                        ?>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Date</td>
                <td>
                    <input type="text" id="from_date"/>
                    <img src="<?php echo $this->getSkinUrl('images/grid-cal.gif');?>" class="v-middle" id="img_from_date">
                    <script type="text/javascript">
                        Calendar.setup({
                            inputField : document.getElementById('from_date'),
                            ifFormat : '%Y-%m-%e',
                            button : document.getElementById('img_from_date'),
                            align : 'Bl',
                            singleClick : true
                        });
                    </script>
                </td>
            </tr>
            <!--<tr>
                <td>To date</td>
                <td>
                    <input type="text" id="to_date"/>
                    <img src="<?php //echo $this->getSkinUrl('images/grid-cal.gif');?>" class="v-middle" id="img_to_date">
                    <script type="text/javascript">
                        Calendar.setup({
                            inputField : document.getElementById('to_date'),
                            ifFormat : '%Y-%m-%e',
                            button : document.getElementById('img_to_date'),
                            align : 'Bl',
                            singleClick : true
                        });
                    </script>
                </td>
            </tr>-->
            <tr>
                <td>Caption</td>
                <td>
                    <input type="text" id="caption"/>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <button id="submit_holi" onclick="holisubmit();">Submit</button>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="daydetails" id="daydetails" style="display:none;">
    <div class="daydetailsclose" onclick="document.getElementById('daydetails').style.display = 'none';">X</div>
    <div id="details">gfhtgfh</div>
</div>


<style>



.daydetails{
    width: 725px;
border: 1px solid #CCC;
position: fixed;
top: 125px;
left: 280px;
background-color: white;
min-height: 249px;
box-shadow: 0 2px 4px rgba(0,0,0,.2);
z-index: 100;
}
.deatilshead{
    font-weight: bold;
font-size: 22px;
padding-bottom: 10px;
padding-left: 10px;
padding-top: 5px;
}
.odd1{
    margin-left: 15px;
margin-right: 15px;
background-color:#DBA901;

}

.even1{
    margin-left: 15px;
margin-right: 15px;
background-color:#F5DA81;

}
.odd1 a{
    color: #29220A;
    font-weight: bold;
    padding-left: 10px;
    text-decoration: initial;
}
.even1 a{
    color: #29220A;
    font-weight: bold;
    padding-left: 10px;
    text-decoration: initial;
}

.headdate{
    background-color: #0B3B0B;
    text-align: center;
    font-size: 18px;
    color: #E6E6E6;
    margin: 12px;
}

.daydetailsclose{
    width: 20px;
float: right;
font-size: 22px;
margin-top: 6px;
cursor:pointer;
}
.addtask{
    width: 565px;
height: 306px;
position: fixed;
top: 50px;
left: 20%;
background-color: white;
z-index: 999;
box-shadow: 0 2px 4px rgba(0,0,0,.2);
background: white;
border: 1px solid #CCC;
}
.addholi{
    width: 565px;
height: 306px;
position: fixed;
top: 50px;
left: 20%;
background-color: white;
z-index: 999;
box-shadow: 0 2px 4px rgba(0,0,0,.2);
background: white;
border: 1px solid #CCC;
}
.addholimain{
    margin-top: 54px;
margin-left: 50px
}

.addclose{
position: fixed;
left: 808px;
top: 64px;
cursor:pointer;
font-size: 18px;
}

.allover{
    position: fixed;
background-color: black;
width: 100%;
height: 100%;
top: 0px;
left: 0px;
opacity: 0.5;
z-index: 998;
}
</style>

<script type="text/javascript">
    
    function sc_next_month(m,y,country)
    {
        //alert(m+" "+y);
        sc_loadXMLDoc(m,y,country);
    }
    
    function sc_prev_month(m,y,country)
    {
        //alert(m+" "+y);
        sc_loadXMLDoc(m,y,country);
    }
    
    function sc_loadXMLDoc(m,y,country,d,type)
    {
        var xmlhttp;
        
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                
                document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                document.getElementById('extent_id').value = '';
                varienLoaderHandler.handler.onComplete();

              
                
            }
          }
          
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
          
          if(type == 'day')
          xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/eventday/?m="+m+"&y="+y+"&d="+d+"&form_key="+form_key+"&isAjax=true",true);
          else if(type == 'week')
          xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/eventweek/?m="+m+"&y="+y+"&d="+d+"&form_key="+form_key+"&isAjax=true",true);
          else if(type == '4day')
          xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/event4day/?m="+m+"&y="+y+"&d="+d+"&form_key="+form_key+"&isAjax=true",true);
          else if(type == 'year')
          xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/eventyear/?m="+m+"&y="+y+"&d="+d+"&form_key="+form_key+"&isAjax=true",true);
          else
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/eventmonth/?m="+m+"&y="+y+"&form_key="+form_key+"&isAjax=true",true);
//enable loader image
                        var r = {options:{loadArea:''}};
                        varienLoaderHandler.handler.onCreate(r);

        xmlhttp.send();
        
        
       
    }
    
    function sc_open_pop(iid)
    {
        arr=Array();
        arr=iid.split("__");
        
        var num=arr[1];
        
        document.getElementById("sc_ov__"+num).style.display="block";
        document.getElementById("sc_ou__"+num).style.display="block";
        
        
        
    }
    
    function sc_close_pop(iid)
    {
        
        arr=Array();
        arr=iid.split("__");
        
        var num=arr[1];
        
        document.getElementById("sc_ov__"+num).style.display="none";
        document.getElementById("sc_ou__"+num).style.display="none";
       
        
    }
    
    function addtask(m,y,d,t)
    {
        document.getElementById("addtask").style.display="block";
        //document.getElementById("allover").style.display="block";
        if(m<10)
        m='0'+m;
        document.getElementById("ot_created_date").value = y+'-'+m+'-'+d;
        if(t != '')
        document.getElementById("ot_time").value = t;
        //document.getElementById("ot_event").value = m+'@'+y+'@'+document.getElementById('holiday_country').value;
        document.getElementById("ot_event").value = m+'@'+y+'@'+' ';
        close_expan();
    }
    
    function addtodo(task_id,id)
    {
        
        close_expan();
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                
                document.getElementById('tabletask').innerHTML = xmlhttp.responseText;
                document.getElementById("addtask1").style.display="block";
                var caption = document.getElementById('todo_'+id).value.split('.');
                document.getElementById('edit_form_task_1').elements['ot_caption'].value=caption[0];
                
                if(task_id == ' ')
                {
                 var projects = [
                        <?php echo $orderdata;?>
                      ];
                      
                      var quote = [
                        <?php echo $quotedata;?>
                      ];
                      
                  var product = [
                        <?php echo $productdata;?>
                      ];
                   
                      jQuery( "#order1" ).autocomplete({
                        minLength: 0,
                        source: projects,
                        focus: function( event, ui ) {
                          jQuery( "#order1" ).val( ui.item.label );
                          return false;
                        },
                        select: function( event, ui ) {
                          jQuery( "#order1" ).val( ui.item.label );
                         
                   
                          return false;
                        }
                      })
                      
                  jQuery( "#quote1" ).autocomplete({
                        minLength: 0,
                        source: quote,
                        focus: function( event, ui ) {
                          jQuery( "#quote1" ).val( ui.item.label );
                          return false;
                        },
                        select: function( event, ui ) {
                          jQuery( "#quote1" ).val( ui.item.label );
                         
                   
                          return false;
                        }
                      })
                  
                  jQuery( "#product1" ).autocomplete({
                        minLength: 0,
                        source: product,
                        focus: function( event, ui ) {
                          jQuery( "#product1" ).val( ui.item.label );
                          return false;
                        },
                        select: function( event, ui ) {
                          jQuery( "#product1" ).val( ui.item.label );
                         
                   
                          return false;
                        }
                      })
                      .data( "ui-autocomplete" )._renderItem = function( ul, item ) {
                        return jQuery( "<li>" )
                          .append( "<a>" + item.label + "<br>"  + "</a>" )
                          .appendTo( ul );
                      };
                }
               // document.getElementById("allover").style.display="block";
               <?php
               //Add Permistion 'Able to edit notification date'
		$all_permission = Mage::getSingleton('core/session')->getAllpermission();
            
		if(in_array(14,$all_permission))
		{
               ?>
                Calendar.setup({
                                    inputField : document.getElementById('edit_form_task_1').elements['ot_notify_date'],
                                    ifFormat : '%Y-%m-%e',
                                    button : document.getElementById('edit_form_task_1').elements['img_ot_notify_date'],
                                    align : 'Bl',
                                    singleClick : true
                                });
                <?php
                }
                
                //Add Permistion 'Able to edit deadline'
		$all_permission = Mage::getSingleton('core/session')->getAllpermission();
            
		if(in_array(17,$all_permission))
		{
                ?>
                
                 Calendar.setup({
                                        inputField : document.getElementById('edit_form_task_1').elements['ot_deadline'],
                                        ifFormat : '%Y-%m-%e',
                                        button : document.getElementById('edit_form_task_1').elements['img_ot_deadline'],
                                        align : 'Bl',
                                        singleClick : true
                                    });
                <?php
                }
                ?>
                 Calendar.setup({
                                        inputField : document.getElementById('edit_form_task_1').elements['ot_created_date'],
                                        //inputField : document.getElementById('edit_form_task_').elements['ot_create'],
                                        ifFormat : '%Y-%m-%e',
                                        button : document.getElementById('edit_form_task_1').elements['img_ot_create'],
                                        align : 'Bl',
                                        singleClick : true
                                    });
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/edittodotask/?task_id="+task_id+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
        
    }
    
     function loadtodo()
    {
        
        close_expan();
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                
                document.getElementById('todobody').innerHTML = xmlhttp.responseText;
              
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/loadtodo/?form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
        
    }
    
    function closetask()
    {
        document.getElementById("addtask").style.display="none";
        //document.getElementById("allover").style.display="none";
    }
    
    function closetask1()
    {
        document.getElementById("addtask1").style.display="none";
        //document.getElementById("allover").style.display="none";
    }
    
    function checktype(type)
    {
        if(type == 'order')
        {
            document.getElementById("order_id").style.display="block";
            document.getElementById("number").style.display="none";
            document.getElementById("pro_id").style.display="none";
            document.getElementById("quote_id").style.display="none";
            
        }
        else if(type == 'quote')
        {
            document.getElementById("quote_id").style.display="block";
            document.getElementById("number").style.display="none";
            document.getElementById("pro_id").style.display="none";
            document.getElementById("order_id").style.display="none";
            
        }
        else if(type == 'product')
        {
            document.getElementById("pro_id").style.display="block";
            document.getElementById("number").style.display="";
            document.getElementById("order_id").style.display="none";
            document.getElementById("quote_id").style.display="none";
            
        }
        else
        {
            document.getElementById("order_id").style.display="none";
            document.getElementById("number").style.display="none";
            document.getElementById("pro_id").style.display="none";
            document.getElementById("quote_id").style.display="none";
        }
        
    }
    
function checktype1(type)
    {
        if(type == 'order')
        {
            document.getElementById("order_id1").style.display="block";
            document.getElementById("number1").style.display="none";
            document.getElementById("pro_id1").style.display="none";
            document.getElementById("quote_id1").style.display="none";
            
        }
        else if(type == 'quote')
        {
            document.getElementById("quote_id1").style.display="block";
            document.getElementById("number1").style.display="none";
            document.getElementById("pro_id1").style.display="none";
            document.getElementById("order_id1").style.display="none";
            
        }
        else if(type == 'product')
        {
            document.getElementById("pro_id1").style.display="block";
            document.getElementById("number1").style.display="";
            document.getElementById("order_id1").style.display="none";
            document.getElementById("quote_id1").style.display="none";
            
        }
        else
        {
            document.getElementById("order_id1").style.display="none";
            document.getElementById("number1").style.display="none";
            document.getElementById("pro_id1").style.display="none";
            document.getElementById("quote_id1").style.display="none";
        }
        
    }
    
    function set_order()
    {
        document.getElementById('edit_form_task_').elements['ot_entity_type'].value="order";
        document.getElementById('edit_form_task_').elements['ot_entity_id'].value=jQuery('#order_id span').html();
        document.getElementById('edit_form_task_').elements['ot_entity_description'].value='order #'+document.getElementById('order').value;
        
        chkitem(jQuery('#order_id span').html());
    }
    
    function set_order1()
    {
        document.getElementById('edit_form_task_1').elements['ot_entity_type'].value="order";
        document.getElementById('edit_form_task_1').elements['ot_entity_id'].value=jQuery('#order_id1 span').html();
        document.getElementById('edit_form_task_1').elements['ot_entity_description'].value='order #'+document.getElementById('order1').value;
        chkitem1(jQuery('#order_id1 span').html());
    }
    
    function set_product()
    {
        document.getElementById('edit_form_task_').elements['ot_entity_type'].value="product";
        document.getElementById('edit_form_task_').elements['ot_entity_id'].value=jQuery('#pro_id span').html();
        document.getElementById('edit_form_task_').elements['ot_entity_description'].value=document.getElementById('product').value;
        chkitem(jQuery('#pro_id span').html());
    }
    function set_product1()
    {
        document.getElementById('edit_form_task_1').elements['ot_entity_type'].value="product";
        document.getElementById('edit_form_task_1').elements['ot_entity_id'].value=jQuery('#pro_id1 span').html();
        document.getElementById('edit_form_task_1').elements['ot_entity_description'].value=document.getElementById('product1').value;
        
    }
    
    function set_quote()
    {
        document.getElementById('edit_form_task_').elements['ot_entity_type'].value="quote";
        document.getElementById('edit_form_task_').elements['ot_entity_id'].value=jQuery('#quote_id span').html();
        document.getElementById('edit_form_task_').elements['ot_entity_description'].value='quote #'+document.getElementById('quote').value;
        chkitem(jQuery('#quote_id span').html());
    }
    
    function set_quote1()
    {
        document.getElementById('edit_form_task_1').elements['ot_entity_type'].value="quote";
        document.getElementById('edit_form_task_1').elements['ot_entity_id'].value=jQuery('#quote_id1 span').html();
        document.getElementById('edit_form_task_1').elements['ot_entity_description'].value='quote #'+document.getElementById('quote1').value;
        chkitem1(jQuery('#quote_id1 span').html());
    }
    
    function edittask(task_id)
    {
        close_expan();
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                
                document.getElementById('tabletask').innerHTML = xmlhttp.responseText;
                document.getElementById("addtask1").style.display="block";
               // document.getElementById("allover").style.display="block";
               <?php
               //Add Permistion 'Able to edit notification date'
		$all_permission = Mage::getSingleton('core/session')->getAllpermission();
            
		if(in_array(14,$all_permission))
		{
               ?>
                Calendar.setup({
                                    inputField : document.getElementById('edit_form_task_1').elements['ot_notify_date'],
                                    ifFormat : '%Y-%m-%e',
                                    button : document.getElementById('edit_form_task_1').elements['img_ot_notify_date1'],
                                    align : 'Bl',
                                    singleClick : true
                                });
                <?php
                
                }
                
                //Add Permistion 'Able to edit deadline'
		$all_permission = Mage::getSingleton('core/session')->getAllpermission();
            
		if(in_array(17,$all_permission))
		{
                ?>
                
                 Calendar.setup({
                                        inputField : document.getElementById('edit_form_task_1').elements['ot_deadline'],
                                        ifFormat : '%Y-%m-%e',
                                        button : document.getElementById('edit_form_task_1').elements['img_ot_deadline1'],
                                        align : 'Bl',
                                        singleClick : true
                                    });
                <?php }
                
                ?>
            }
          }
          
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/edittask/?task_id="+task_id+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
    }
    
    
    function deletetask(task_id)
    {
        close_expan();
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                closetask1();
                var type = document.getElementById('catformat').value.split('-');
                var date = document.getElementById('nowdate').value.split('-');
                sc_loadXMLDoc(date[1],date[0],'',date[2],type);
              
            }
          }
          
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/deletetask/?task_id="+task_id+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
    }
    
    function chkitem(order_quote_id)
    {
        var entity_type = document.getElementById('entity_type').value;
        
        if(entity_type == 'order' || entity_type == 'quote')
        {
            var xmlhttp;
            if (window.XMLHttpRequest)
              {// code for IE7+, Firefox, Chrome, Opera, Safari
              xmlhttp=new XMLHttpRequest();
              }
            else
              {// code for IE6, IE5
              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
              }
            xmlhttp.onreadystatechange=function()
              {
              if (xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                    //alert(xmlhttp.responseText);
                    document.getElementById('task_item').innerHTML = xmlhttp.responseText;
                    
                  
                }
              }
              
              form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
            xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/loadtaskitem/?order_quote_id="+order_quote_id+"&entity_type="+entity_type+"&form_key="+form_key+"&isAjax=true",true);
            xmlhttp.send();
        }
    }
    
    function chkitem1(order_quote_id)
    {
        var entity_type = document.getElementById('entity_type1').value;
        
        if(entity_type == 'order' || entity_type == 'quote')
        {
            var xmlhttp;
            if (window.XMLHttpRequest)
              {// code for IE7+, Firefox, Chrome, Opera, Safari
              xmlhttp=new XMLHttpRequest();
              }
            else
              {// code for IE6, IE5
              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
              }
            xmlhttp.onreadystatechange=function()
              {
              if (xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                    //alert(xmlhttp.responseText);
                    document.getElementById('task_item1').innerHTML = xmlhttp.responseText;
                    
                  
                }
              }
              
              form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
            xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/loadtaskitem/?order_quote_id="+order_quote_id+"&entity_type="+entity_type+"&form_key="+form_key+"&isAjax=true",true);
            xmlhttp.send();
        }
    }
    
    function expand(id)
    {
        if(document.getElementById('extent_id').value != '')
        document.getElementById('expand_'+document.getElementById('extent_id').value).style.display = 'none';
        document.getElementById('extent_id').value = id;
        document.getElementById('expand_'+id).style.display = 'block';
    }
    
    function expand1(id,id1)
    {
        
        if(document.getElementById('extent_id').value != '')
        document.getElementById('expand_'+document.getElementById('extent_id').value).style.display = 'none';
        document.getElementById('extent_id').value = id+'_'+id1;
        document.getElementById('expand_'+id+'_'+id1).style.display = 'block';
        
    }
    
    function close_expan()
    {
        holiclose();
        if(document.getElementById('extent_id').value != '')
        document.getElementById('expand_'+document.getElementById('extent_id').value).style.display = 'none';
        
        document.getElementById('extent_id').value = '';
    }
    
    function holipop(id)
    {
        close_expan();
        if(document.getElementById('holi_id').value != '')
        holiclose();
        document.getElementById('details_'+id).style.display = 'block';
        document.getElementById('holi_id').value = id;
    }
    
    function holipop1(id,id1)
    {
        close_expan();
        if(document.getElementById('holi_id').value != '')
        holiclose();
        document.getElementById('details_'+id+'_'+id1).style.display = 'block';
        document.getElementById('holi_id').value = id+'_'+id1;
    }
    
    function holiclose()
    {
        if(document.getElementById('holi_id').value != '')
        {
            document.getElementById('details_'+document.getElementById('holi_id').value).style.display = 'none';
            document.getElementById('holi_id').value = '';
        }
    }
    
    function holiadd()
    {
       
        document.getElementById('addholi').style.display = 'block';
    }
    
    function holiaddclose()
    {
       
        document.getElementById('addholi').style.display = 'none';
    }
    
    function holisubmit()
    {
        var country = document.getElementById('addcountry').value;
        var from_date = document.getElementById('from_date').value;
        var caption = document.getElementById('caption').value;
        
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                
                //document.getElementById('todobody').innerHTML = xmlhttp.responseText;
                
                if(xmlhttp.responseText != '')
                alert(xmlhttp.responseText);
                else{
                    alert('Holiday added successfully.');
                    document.getElementById('addcountry').value = '';
                    document.getElementById('from_date').value = '';
                    document.getElementById('caption').value = '';
                    document.getElementById('addholi').style.display = 'none';
                    var type = document.getElementById('catformat').value.split('-');
                    var date = document.getElementById('nowdate').value.split('-');
                    sc_loadXMLDoc(date[1],date[0],'',date[2],type);
                }
              
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/holisubmit/?country="+country+"&from_date="+from_date+"&caption="+caption+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
        
    }
    
    function holidelete(id)
    {
        
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
                //alert(xmlhttp.responseText);
                
                //document.getElementById('todobody').innerHTML = xmlhttp.responseText;
                
                if(xmlhttp.responseText != '')
                {
                    alert(xmlhttp.responseText);
                    holiclose();
                    var type = document.getElementById('catformat').value.split('-');
                    var date = document.getElementById('nowdate').value.split('-');
                    sc_loadXMLDoc(date[1],date[0],'',date[2],type);

                }
                else{
                    alert('There are some problem to delete.');
                }
              
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/holidelete/?holi_id="+id+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
        
    }
    
    function chkholi(holiid,m,y,type)
    {
        close_expan();
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
               // alert(xmlhttp.responseText);
               var date = document.getElementById('nowdate').value.split('-');
                sc_loadXMLDoc(m,y,'',date[2],type);
                
               
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/chkholi/?holiid="+holiid+"&form_key="+form_key+"&isAjax=true",true);
        //xmlhttp.open("GET","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>ajax/remove_holi.php?holiid="+holiid,true);
        xmlhttp.send();
    }
    
    function checkclock(clockid)
    {
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //document.getElementById("sc_cal_out").innerHTML=xmlhttp.responseText;
               //alert(xmlhttp.responseText);
               var str1 = xmlhttp.responseText.split('@');
               var str = str1[0].split(',');
              
               var flag = 0;
               for(i=0;i<str.length-1;i++)
               {
                   
                    document.getElementById(trim(str[i])).style.display='block';
                    if(trim(str[i]) == str1[1])
                    flag=1;
               } 
               
               if(flag == 0)
               document.getElementById(str1[1]).style.display='none';
                
               
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/clock/?clockid="+clockid+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
    }
    
    function daydetails(daydate)
    {
        
        var xmlhttp;
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
               //alert(xmlhttp.responseText);
               if(xmlhttp.responseText == '<div class="detailsmain" style="margin-top: 10px;"></div>')
               {
                 alert("There are no records for Quote,Payment,Delivary,Proof.");
               }
               else
               {
                document.getElementById('details').innerHTML = xmlhttp.responseText;
                document.getElementById('daydetails').style.display = 'block';
                }
               
            }
          }
          form_key = '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>';
        xmlhttp.open("POST","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB); ?>index.php/eventcalendar/adminhtml_eventcalendar/daydetails/?daydate="+daydate+"&form_key="+form_key+"&isAjax=true",true);
        xmlhttp.send();
    }
    
    function trim(s)
    {
            var l=0; var r=s.length -1;
            while(l < s.length && s[l] == "'")
            {	l++; }
            while(r > l && s[r] == "'")
            {	r-=1;	}
            return s.substring(l, r+1);
    }
    
    function chkseting()
    {
        document.getElementById('wclockdivedit1').style.display='block';
        document.getElementById('settings').style.display='none';
    }
    
     function backclock()
    {
        document.getElementById('wclockdivedit1').style.display='none';
        document.getElementById('settings').style.display='block';
    }
    
    
    
    
    var date = document.getElementById('nowdate').value.split('-');

document.observe('dom:loaded', function() {    
    sc_loadXMLDoc('<?php echo date('n');?>',date[0],'',<?php echo date('d');?>,'<?php echo Mage::getSingleton('core/session')->getFormattype();?>');
    });
</script>


<style>
#details{
    height: 218px;
overflow-y: scroll;
margin-top: 24px;
}
    .outer{
        
        border:1px solid #ff0000;
        width:400px;
        /*height:200px;*/
        min-height: 200px;
        float:left;
        position: fixed;
        z-index: 1000;
        top:150px;
        left:470px;
        background-color: #ffffff;
        display: none;
        
    }
    .inner{
        
        border:0px solid #00ff00;
        width:100%;                
        position: absolute;
        z-index: 1000;
        top:0;
        left:0;
    }
    .lab_txt{
        width: 100px;
        float: left;
        text-align: left
    }
    .lab_val{
        width: 100px;
        float: left;
        text-align: left;
    }
    .cross{
        border:0px solid #00ff00;
        width: 12px;
        position: absolute;
        z-index: 10000;
        top:5px;
        left:384px;
        cursor: pointer;
    }
    .overlay{
        position: fixed;
        z-index: 999;
        top:0px;
        left:0px;
        width: 100%;
        height: 100%;
        background-color: #000000;
        opacity: 0.5;
        display: none;
        
    }
    
.calendar{
left: 634px !important;
top: 155px !important;
position: fixed !important;
z-index:999 !important;
}

.expand{
    display:none;
    position: absolute;
    background-color: white;
    width: 331px;
    top: -1px;
     z-index: 9;
     border: 1px solid #000000;
     min-height: 150px;
}

.expand1{
    display:none;
    position: absolute;
    background-color: white;
    width: 290px;
     z-index: 9;
     border: 1px solid #000000;
     min-height: 150px;
}
.stickhead{
    overflow: hidden;
padding-right: 10px;
}
.holiclose{
    margin-left: 216px;
}
.holipop{
    position: absolute;
width: 228px;
height: 100px;
background-color: white;
text-align: left;
box-shadow: 0 2px 4px rgba(0,0,0,.2);
z-index: 9;
top: -70px;
padding-left: 10px;
border: 1px solid #CCC;
}

.holipop1{
    position: absolute;
width: 228px;
height: 100px;
background-color: white;
text-align: left;
box-shadow: 0 2px 4px rgba(0,0,0,.2);
z-index: 9;
/*top: -70px;*/
padding-left: 10px;
border: 1px solid #CCC;
}

@-moz-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Firefox */
@-webkit-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Webkit */
@-ms-keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* IE */
@keyframes blink {0%{opacity:1;} 50%{opacity:0;} 100%{opacity:1;}} /* Opera and prob css3 final iteration */
.blink {
margin-left: 15px;
-moz-transition:all 1s ease-in-out;
-webkit-transition:all 1s ease-in-out;
-o-transition:all 1s ease-in-out;
-ms-transition:all 1s ease-in-out;
transition:all 1s ease-in-out;
/* order: name, direction, duration, iteration-count, timing-function */  
-moz-animation:blink normal 1s infinite ease-in-out; /* Firefox */
-webkit-animation:blink normal 1s infinite ease-in-out; /* Webkit */
-ms-animation:blink normal 1s infinite ease-in-out; /* IE */
animation:blink normal 1s infinite ease-in-out; /* Opera and prob css3 final iteration */
}
</style>
